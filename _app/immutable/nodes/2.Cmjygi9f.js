import"../chunks/DsnmJJEf.js";import{o as $,_ as Ct,as as k,aC as y,u as mt,aa as t,at as d,aG as et,a5 as Pt,a2 as Ot,af as T,ad as P,a6 as Ht,a4 as wt,$ as Vt,ae as M,aD as jt}from"../chunks/CYXQVpue.js";import{d as Ft,s as it}from"../chunks/q5wOSprp.js";import{b as Nt}from"../chunks/DOpaPJET.js";const yt=[...` 	
\r\f \v\uFEFF`];function Gt(h,e,i){var r=h==null?"":""+h;if(i){for(var a in i)if(i[a])r=r?r+" "+a:a;else if(r.length)for(var n=a.length,f=0;(f=r.indexOf(a,f))>=0;){var v=f+n;(f===0||yt.includes(r[f-1]))&&(v===r.length||yt.includes(r[v]))?r=(f===0?"":r.substring(0,f))+r.substring(v+1):f=v}}return r===""?null:r}function bt(h,e=!1){var i=e?" !important;":";",r="";for(var a in h){var n=h[a];n!=null&&n!==""&&(r+=" "+a+": "+n+i)}return r}function $t(h,e){if(e){var i="",r,a;return Array.isArray(e)?(r=e[0],a=e[1]):r=e,r&&(i+=bt(r)),a&&(i+=bt(a,!0)),i=i.trim(),i===""?null:i}return String(h)}function st(h,e,i,r,a,n){var f=h.__className;if($||f!==i||f===void 0){var v=Gt(i,r,n);(!$||v!==h.getAttribute("class"))&&(v==null?h.removeAttribute("class"):h.className=v),h.__className=i}else if(n&&a!==n)for(var x in n){var Y=!!n[x];(a==null||Y!==!!a[x])&&h.classList.toggle(x,Y)}return n}function rt(h,e={},i,r){for(var a in i){var n=i[a];e[a]!==n&&(i[a]==null?h.style.removeProperty(a):h.style.setProperty(a,n,r))}}function qt(h,e,i,r){var a=h.__style;if($||a!==e){var n=$t(e,r);(!$||n!==h.getAttribute("style"))&&(n==null?h.removeAttribute("style"):h.style.cssText=n),h.__style=e}else r&&(Array.isArray(r)?(rt(h,i?.[0],r[0]),rt(h,i?.[1],r[1],"important")):rt(h,i,r));return r}class Ut{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;draw(e){e.beginPath(),e.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),e.fillStyle="#4299e1",e.fill(),e.closePath()}}class I{x;y;direction;owner;color;speed;size;constructor({x:e,y:i,direction:r,owner:a,color:n="#f6e05e",speed:f=7,size:v=5}){this.x=e,this.y=i,this.direction=r,this.owner=a,this.color=n,this.speed=f,this.size=v}update(e){this.x+=this.direction.x*this.speed*60*e,this.y+=this.direction.y*this.speed*60*e}draw(e){e.beginPath(),e.arc(this.x,this.y,this.size,0,Math.PI*2),e.fillStyle=this.color,e.fill(),e.closePath()}}class at{x;y;health;scoreValue;width=30;height=30;color;speed=4;hitboxRadius=10;fireTimer=0;constructor({x:e,y:i,health:r,scoreValue:a,color:n="#e53e3e"}){this.x=e,this.y=i,this.health=r,this.scoreValue=a,this.color=n}update(e){this.y+=this.speed*60*e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath()}}class _t extends at{fireRate=1;constructor({x:e,y:i,health:r,scoreValue:a,color:n}){super({x:e,y:i,health:r,scoreValue:a,color:n})}}class Tt extends at{fireRate=1.5;constructor({x:e,y:i,health:r,scoreValue:a,color:n}){super({x:e,y:i,health:r,scoreValue:a,color:n})}}class Wt extends at{targetX;targetY;moveOffset={x:0,y:0};fireTimer=0;patterns=[{time:1,type:"spread",speed:4,moveOffset:{x:.5,y:-.5}},{time:2,type:"circular",speed:2,moveOffset:{x:-.5,y:.5}},{time:3,type:"spiral",speed:2,moveOffset:{x:.8,y:.8}},{time:4,type:"random",speed:6,moveOffset:{x:-.8,y:-.8}}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor({x:e,y:i,health:r,scoreValue:a}){super({x:e,y:i,health:r,scoreValue:a,color:"#f56565"}),this.targetX=e,this.targetY=i,this.maxHealth=r}update(e,i,r){const a=this.patterns[this.currentPatternIndex],n=(a.moveOffset.x+1)/2,f=(a.moveOffset.y+1)/2;this.targetX=n*(i-this.width),this.targetY=f*(r*.4-this.height),this.targetX+=this.width/2,this.targetY+=this.height/2,this.x+=(this.targetX-this.x)*this.speed*e,this.y+=(this.targetY-this.y)*this.speed*e,this.fireTimer+=e,this.patternTimer+=e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath();const i=this.width,r=10,a=this.x-i/2,n=this.y-this.height/2-r-5;e.fillStyle="#333",e.fillRect(a,n,i,r);const f=this.health/this.maxHealth*i;e.fillStyle="#27ae60",e.fillRect(a,n,f,r)}}function Dt(){}var Kt=Pt('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Jt=(h,e)=>{e.a=!0},Qt=(h,e)=>{e.a=!1},Zt=(h,e)=>{e.d=!0},te=(h,e)=>{e.d=!1},ee=Pt(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div> <div class="md:hidden absolute bottom-5 w-full flex justify-center gap-5"><button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">◀</button> <button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">▶</button></div></div>`);function oe(h,e){Ct(e,!0);let i,r,a=y(0),n=y(3),f=y(!1),v=y(!1),x=k({}),Y=y(!1),z=y(!1),B=y(0);const Mt=4;let l=k(new Ut),b=y(k([])),E=y(k([])),m=y(k([])),o=y(null),X=y(0),C=y(0);const q=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],Rt="ontouchstart"in globalThis||navigator.maxTouchPoints>0,U=()=>{d(v,!0),d(f,!1),d(a,0),d(n,3),d(b,[],!0),d(E,[],!0),d(m,[],!0),d(o,null),d(X,0),d(C,0),d(z,!1),d(B,0),i&&(l.x=i.width/2,l.y=i.height-80),H=performance.now()};let O,H=0;mt(()=>{if(!t(v)||t(f))return;const u=R=>{const g=(R-H)/1e3;if(H=R,t(Y)){O=requestAnimationFrame(u);return}if(d(C,t(C)+g),!Rt){const s=x.shift?l.speed/2:l.speed;(x.arrowleft||x.a)&&(l.x-=s*60*g),(x.arrowright||x.d)&&(l.x+=s*60*g),(x.arrowup||x.w)&&(l.y-=s*60*g),(x.arrowdown||x.s)&&(l.y+=s*60*g),l.x=Math.max(l.hitboxRadius,Math.min(l.x,i.width-l.hitboxRadius)),l.y=Math.max(l.hitboxRadius,Math.min(l.y,i.height-l.hitboxRadius))}if(l.fireTimer+=g,l.fireTimer>=l.fireRate&&(t(E).push(new I({x:l.x,y:l.y,direction:{x:0,y:-1},owner:"player"})),l.fireTimer=0),t(z)&&(d(B,t(B)+g),t(B)>=Mt&&(d(z,!1),d(B,0))),d(E,t(E).filter(s=>(s.update(g),s.y>-s.size)),!0),d(m,t(m).filter(s=>(s.update(g),s.y<i.height+s.size&&s.x>-s.size&&s.x<i.width+s.size)),!0),t(b).forEach(s=>{s.y+=s.speed*60*g,s.fireTimer+=g,s instanceof _t?s.fireTimer>=s.fireRate&&(t(m).push(new I({x:s.x,y:s.y+s.height,direction:{x:0,y:1},owner:"enemy",color:"#a0aec0"})),s.fireTimer=0):s instanceof Tt&&s.fireTimer>=s.fireRate&&([-30,-15,0,15,30].forEach(_=>{const c=_*Math.PI/180,p=Math.sin(c),S=Math.cos(c);t(m).push(new I({x:s.x,y:s.y+s.height,direction:{x:p,y:S},owner:"enemy",color:"#a0aec0"}))}),s.fireTimer=0)}),d(b,t(b).filter(s=>s.y<i.height+s.height),!0),t(X)<q.length){const s=q[t(X)];t(C)>=s.time&&(s.type==="straight"?t(b).push(new _t({x:s.x,y:-50,health:10,scoreValue:10})):s.type==="spread"&&t(b).push(new Tt({x:s.x,y:-50,health:15,scoreValue:20})),et(X))}if(t(X)>=q.length&&t(b).length===0&&!t(o)&&d(o,new Wt({x:i.width/2,y:100,health:500,scoreValue:1e3}),!0),t(o)){t(o).update(g,i.width,i.height);const s=t(o).patterns[t(o).currentPatternIndex];if(t(o).patternTimer>=s.time&&(t(o).currentPatternIndex=(t(o).currentPatternIndex+1)%t(o).patterns.length,t(o).patternTimer=0),t(o).fireTimer>=.5){const w=s.speed;switch(s.type){case"spread":for(let _=-2;_<=2;_++){const p=_*15*Math.PI/180,S=Math.sin(p),A=Math.cos(p);t(m).push(new I({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:S,y:A},owner:"enemy",color:"#ecc94b",speed:w,size:8}))}break;case"circular":{for(let c=0;c<12;c++){const p=c/12*Math.PI*2,S=Math.sin(p)*w,A=Math.cos(p)*w;t(m).push(new I({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:S,y:A},owner:"enemy",color:"#ecc94b",speed:w,size:6}))}break}case"spiral":{const c=t(o).fireTimer;for(let p=0;p<8;p++){const S=p/8*Math.PI*2+c,A=Math.sin(S)*w,kt=Math.cos(S)*w;t(m).push(new I({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:A,y:kt},owner:"enemy",color:"#ecc94b",speed:w,size:6}))}break}case"random":Math.random()>.5&&t(m).push(new I({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:Math.random()*2-1,y:1},owner:"enemy",color:"#ecc94b",speed:w,size:6}));break}t(o).fireTimer=0}}(()=>{const s=new Set,w=new Set;let _=t(a);t(E).forEach(c=>{t(b).forEach(p=>{Math.hypot(c.x-p.x,c.y-p.y)<p.hitboxRadius+c.size&&(s.add(c),w.add(p),p.health-=1,p.health<=0&&(_+=p.scoreValue))}),t(o)&&Math.hypot(c.x-t(o).x,c.y-t(o).y)<t(o).hitboxRadius+c.size&&(s.add(c),t(o).health-=1,t(o).health<=0&&(_+=t(o).scoreValue))}),t(z)||(t(m).forEach(c=>{Math.hypot(c.x-l.x,c.y-l.y)<l.hitboxRadius+c.size&&(s.add(c),et(n,-1),t(n)<=0?d(f,!0):d(z,!0))}),t(b).forEach(c=>{Math.hypot(c.x-l.x,c.y-l.y)<l.hitboxRadius+c.hitboxRadius&&(et(n,-1),t(n)<=0?d(f,!0):d(z,!0),w.add(c))})),d(E,t(E).filter(c=>!s.has(c)),!0),d(b,t(b).filter(c=>c.health>0&&!w.has(c)),!0),d(m,t(m).filter(c=>!s.has(c)),!0),d(a,_,!0)})(),r.clearRect(0,0,i.width,i.height),(!t(z)||t(z)&&Math.floor(t(B)*60/10)%2===0)&&l.draw(r);for(const s of t(E))s.draw(r);for(const s of t(b))s.draw(r);for(const s of t(m))s.draw(r);t(o)&&t(o).draw(r),O=requestAnimationFrame(u)};return O=requestAnimationFrame(u),()=>cancelAnimationFrame(O)});const ot=u=>{x[u.key.toLowerCase()]=!0},nt=u=>{x[u.key.toLowerCase()]=!1};let V=0,j=0;function St(u){!t(v)||t(f)?U():(V=u.touches[0].clientX,j=u.touches[0].clientY,l.x=V,l.y=j)}function zt(u){if(!t(v)||t(f))return;const R=u.touches[0].clientX,g=u.touches[0].clientY,G=R-V,s=g-j;l.x+=G,l.y+=s,V=R,j=g}const ht=()=>{d(Y,!0)},lt=()=>{d(Y,!1),H=performance.now()};mt(()=>(i&&(r=i.getContext("2d"),W(),l.x=i.width/2,l.y=i.height-80),window.addEventListener("keydown",ot),window.addEventListener("keyup",nt),window.addEventListener("resize",W),window.addEventListener("blur",ht),window.addEventListener("focus",lt),()=>{window.removeEventListener("keydown",ot),window.removeEventListener("keyup",nt),window.removeEventListener("resize",W),window.removeEventListener("blur",ht),window.removeEventListener("focus",lt)}));function W(){const u=document.querySelector(".relative.max-w-lg");u&&(i.width=u.offsetWidth,i.height=u.offsetHeight)}const Et=jt(()=>t(o)?t(o).health/t(o).maxHealth*100:0);var L=ee();Ot(u=>{var R=Kt();wt(u,R)}),L.__touchstart=St,L.__touchmove=zt,L.__touchend=[Dt];var D=P(L),ct=P(D);Nt(ct,u=>i=u,()=>i);var K=T(ct,2),J=P(K),It=P(J);M(J);var dt=T(J,2),Yt=P(dt);M(dt),M(K);var F=T(K,2);let ft;var Bt=P(F);let ut;M(F);var N=T(F,2);let pt;var Lt=T(P(N),4);Lt.__click=U,M(N);var Q=T(N,2);let xt;var Z=T(P(Q),2),Xt=P(Z);M(Z);var At=T(Z,2);At.__click=U,M(Q),M(D);var gt=T(D,2),tt=P(gt);tt.__touchstart=[Jt,x],tt.__touchend=[Qt,x];var vt=T(tt,2);vt.__touchstart=[Zt,x],vt.__touchend=[te,x],M(gt),M(L),Ht((u,R,g,G)=>{it(It,`スコア: ${t(a)??""}`),it(Yt,`残機: ${t(n)??""}`),ft=st(F,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,ft,u),ut=qt(Bt,"",ut,R),pt=st(N,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,pt,g),xt=st(Q,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,xt,G),it(Xt,`最終スコア: ${t(a)??""}`)},[()=>({hidden:!t(o)}),()=>({width:`${t(Et)}%`}),()=>({hidden:t(v)}),()=>({hidden:!t(f)})]),wt(h,L),Vt()}Ft(["touchstart","touchmove","touchend","click"]);export{oe as component};
