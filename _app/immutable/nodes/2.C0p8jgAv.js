import"../chunks/DsnmJJEf.js";import{o as N,_ as Ye,as as C,aC as v,u as te,aa as e,at as l,aG as ie,a5 as Pe,a2 as ke,af as M,ad as R,a6 as Ce,a4 as ye,$ as Oe,ae as P,aD as He}from"../chunks/CYXQVpue.js";import{d as Ve,s as se}from"../chunks/q5wOSprp.js";import{b as je}from"../chunks/DOpaPJET.js";const be=[...` 	
\r\f \v\uFEFF`];function Fe(o,t,i){var s=o==null?"":""+o;if(i){for(var a in i)if(i[a])s=s?s+" "+a:a;else if(s.length)for(var h=a.length,f=0;(f=s.indexOf(a,f))>=0;){var g=f+h;(f===0||be.includes(s[f-1]))&&(g===s.length||be.includes(s[g]))?s=(f===0?"":s.substring(0,f))+s.substring(g+1):f=g}}return s===""?null:s}function _e(o,t=!1){var i=t?" !important;":";",s="";for(var a in o){var h=o[a];h!=null&&h!==""&&(s+=" "+a+": "+h+i)}return s}function Ne(o,t){if(t){var i="",s,a;return Array.isArray(t)?(s=t[0],a=t[1]):s=t,s&&(i+=_e(s)),a&&(i+=_e(a,!0)),i=i.trim(),i===""?null:i}return String(o)}function re(o,t,i,s,a,h){var f=o.__className;if(N||f!==i||f===void 0){var g=Fe(i,s,h);(!N||g!==o.getAttribute("class"))&&(g==null?o.removeAttribute("class"):o.className=g),o.__className=i}else if(h&&a!==h)for(var p in h){var L=!!h[p];(a==null||L!==!!a[p])&&o.classList.toggle(p,L)}return h}function ae(o,t={},i,s){for(var a in i){var h=i[a];t[a]!==h&&(i[a]==null?o.style.removeProperty(a):o.style.setProperty(a,h,s))}}function De(o,t,i,s){var a=o.__style;if(N||a!==t){var h=Ne(t,s);(!N||h!==o.getAttribute("style"))&&(h==null?o.removeAttribute("style"):o.style.cssText=h),o.__style=t}else s&&(Array.isArray(s)?(ae(o,i?.[0],s[0]),ae(o,i?.[1],s[1],"important")):ae(o,i,s));return s}class Ge{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;draw(t){t.beginPath(),t.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),t.fillStyle="#4299e1",t.fill(),t.closePath()}}class I{x;y;direction;owner;color;speed;size;constructor({x:t,y:i,direction:s,owner:a,color:h="#f6e05e",speed:f=7,size:g=5}){this.x=t,this.y=i,this.direction=s,this.owner=a,this.color=h,this.speed=f,this.size=g}update(t){this.x+=this.direction.x*this.speed*60*t,this.y+=this.direction.y*this.speed*60*t}draw(t){t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.closePath()}}class oe{x;y;health;scoreValue;width=30;height=30;color;speed=4;hitboxRadius=10;fireTimer=0;constructor({x:t,y:i,health:s,scoreValue:a,color:h="#e53e3e"}){this.x=t,this.y=i,this.health=s,this.scoreValue=a,this.color=h}update(t){this.y+=this.speed*60*t}draw(t){t.beginPath(),t.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),t.fillStyle=this.color,t.fill(),t.closePath()}}class Me extends oe{fireRate=1;constructor({x:t,y:i,health:s,scoreValue:a,color:h}){super({x:t,y:i,health:s,scoreValue:a,color:h})}}class Re extends oe{fireRate=1.5;constructor({x:t,y:i,health:s,scoreValue:a,color:h}){super({x:t,y:i,health:s,scoreValue:a,color:h})}}class We extends oe{targetX;targetY;moveOffset={x:0,y:0};fireTimer=0;patterns=[{time:1,type:"spread",speed:4,moveOffset:{x:.5,y:-.5}},{time:2,type:"circular",speed:2,moveOffset:{x:-.5,y:.5}},{time:3,type:"spiral",speed:2,moveOffset:{x:.8,y:.8}},{time:4,type:"random",speed:6,moveOffset:{x:-.8,y:-.8}}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor({x:t,y:i,health:s,scoreValue:a}){super({x:t,y:i,health:s,scoreValue:a,color:"#f56565"}),this.targetX=t,this.targetY=i,this.maxHealth=s}update(t,i,s){const a=this.patterns[this.currentPatternIndex],h=(a.moveOffset.x+1)/2,f=(a.moveOffset.y+1)/2;this.targetX=h*(i-this.width),this.targetY=f*(s*.4-this.height),this.targetX+=this.width/2,this.targetY+=this.height/2,this.x+=(this.targetX-this.x)*this.speed*t,this.y+=(this.targetY-this.y)*this.speed*t,this.fireTimer+=t,this.patternTimer+=t}draw(t){t.beginPath(),t.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),t.fillStyle=this.color,t.fill(),t.closePath();const i=this.width,s=10,a=this.x-i/2,h=this.y-this.height/2-s-5;t.fillStyle="#333",t.fillRect(a,h,i,s);const f=this.health/this.maxHealth*i;t.fillStyle="#27ae60",t.fillRect(a,h,f,s)}}function $e(o,t,i,s,a){if(!e(t)||e(i)){s();return}o.preventDefault(),a(o.touches[0].clientX)}function qe(o,t,i,s){!e(t)||e(i)||(o.preventDefault(),s(o.touches[0].clientX))}function Ue(o,t,i){l(t,!1),l(i,!1)}var Ke=Pe('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Je=(o,t)=>{t.a=!0},Qe=(o,t)=>{t.a=!1},Ze=(o,t)=>{t.d=!0},et=(o,t)=>{t.d=!1},tt=Pe(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div> <div class="md:hidden absolute bottom-5 w-full flex justify-center gap-5"><button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">◀</button> <button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">▶</button></div></div>`);function nt(o,t){Ye(t,!0);let i,s,a=v(0),h=v(3),f=v(!1),g=v(!1),p=C({}),L=v(!1),S=v(!1),B=v(0);const Te=4;let c=C(new Ge),b=v(C([])),z=v(C([])),m=v(C([])),n=v(null),Y=v(0),O=v(0);const D=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],G=()=>{l(g,!0),l(f,!1),l(a,0),l(h,3),l(b,[],!0),l(z,[],!0),l(m,[],!0),l(n,null),l(Y,0),l(O,0),l(S,!1),l(B,0),i&&(c.x=i.width/2,c.y=i.height-80),V=performance.now()};let H,V=0;te(()=>{if(!e(g)||e(f))return;const x=E=>{const w=(E-V)/1e3;if(V=E,e(L)){H=requestAnimationFrame(x);return}l(O,e(O)+w);const X=p.shift?c.speed/2:c.speed;if((p.arrowleft||p.a)&&(c.x-=X*60*w),(p.arrowright||p.d)&&(c.x+=X*60*w),(p.arrowup||p.w)&&(c.y-=X*60*w),(p.arrowdown||p.s)&&(c.y+=X*60*w),c.x=Math.max(c.hitboxRadius,Math.min(c.x,i.width-c.hitboxRadius)),c.y=Math.max(c.hitboxRadius,Math.min(c.y,i.height-c.hitboxRadius)),c.fireTimer+=w,c.fireTimer>=c.fireRate&&(e(z).push(new I({x:c.x,y:c.y,direction:{x:0,y:-1},owner:"player"})),c.fireTimer=0),e(S)&&(l(B,e(B)+w),e(B)>=Te&&(l(S,!1),l(B,0))),l(z,e(z).filter(r=>(r.update(w),r.y>-r.size)),!0),l(m,e(m).filter(r=>(r.update(w),r.y<i.height+r.size&&r.x>-r.size&&r.x<i.width+r.size)),!0),e(b).forEach(r=>{r.y+=r.speed*60*w,r.fireTimer+=w,r instanceof Me?r.fireTimer>=r.fireRate&&(e(m).push(new I({x:r.x,y:r.y+r.height,direction:{x:0,y:1},owner:"enemy",color:"#a0aec0"})),r.fireTimer=0):r instanceof Re&&r.fireTimer>=r.fireRate&&([-30,-15,0,15,30].forEach(_=>{const d=_*Math.PI/180,u=Math.sin(d),T=Math.cos(d);e(m).push(new I({x:r.x,y:r.y+r.height,direction:{x:u,y:T},owner:"enemy",color:"#a0aec0"}))}),r.fireTimer=0)}),l(b,e(b).filter(r=>r.y<i.height+r.height),!0),e(Y)<D.length){const r=D[e(Y)];e(O)>=r.time&&(r.type==="straight"?e(b).push(new Me({x:r.x,y:-50,health:10,scoreValue:10})):r.type==="spread"&&e(b).push(new Re({x:r.x,y:-50,health:15,scoreValue:20})),ie(Y))}if(e(Y)>=D.length&&e(b).length===0&&!e(n)&&l(n,new We({x:i.width/2,y:100,health:500,scoreValue:1e3}),!0),e(n)){e(n).update(w,i.width,i.height);const r=e(n).patterns[e(n).currentPatternIndex];if(e(n).patternTimer>=r.time&&(e(n).currentPatternIndex=(e(n).currentPatternIndex+1)%e(n).patterns.length,e(n).patternTimer=0),e(n).fireTimer>=.5){const y=r.speed;switch(r.type){case"spread":for(let _=-2;_<=2;_++){const u=_*15*Math.PI/180,T=Math.sin(u),k=Math.cos(u);e(m).push(new I({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:T,y:k},owner:"enemy",color:"#ecc94b",speed:y,size:8}))}break;case"circular":{for(let d=0;d<12;d++){const u=d/12*Math.PI*2,T=Math.sin(u)*y,k=Math.cos(u)*y;e(m).push(new I({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:T,y:k},owner:"enemy",color:"#ecc94b",speed:y,size:6}))}break}case"spiral":{const d=e(n).fireTimer;for(let u=0;u<8;u++){const T=u/8*Math.PI*2+d,k=Math.sin(T)*y,Xe=Math.cos(T)*y;e(m).push(new I({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:k,y:Xe},owner:"enemy",color:"#ecc94b",speed:y,size:6}))}break}case"random":Math.random()>.5&&e(m).push(new I({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:Math.random()*2-1,y:1},owner:"enemy",color:"#ecc94b",speed:y,size:6}));break}e(n).fireTimer=0}}(()=>{const r=new Set,y=new Set;let _=e(a);e(z).forEach(d=>{e(b).forEach(u=>{Math.hypot(d.x-u.x,d.y-u.y)<u.hitboxRadius+d.size&&(r.add(d),y.add(u),u.health-=1,u.health<=0&&(_+=u.scoreValue))}),e(n)&&Math.hypot(d.x-e(n).x,d.y-e(n).y)<e(n).hitboxRadius+d.size&&(r.add(d),e(n).health-=1,e(n).health<=0&&(_+=e(n).scoreValue))}),e(S)||(e(m).forEach(d=>{Math.hypot(d.x-c.x,d.y-c.y)<c.hitboxRadius+d.size&&(r.add(d),ie(h,-1),e(h)<=0?l(f,!0):l(S,!0))}),e(b).forEach(d=>{Math.hypot(d.x-c.x,d.y-c.y)<c.hitboxRadius+d.hitboxRadius&&(ie(h,-1),e(h)<=0?l(f,!0):l(S,!0),y.add(d))})),l(z,e(z).filter(d=>!r.has(d)),!0),l(b,e(b).filter(d=>d.health>0&&!y.has(d)),!0),l(m,e(m).filter(d=>!r.has(d)),!0),l(a,_,!0)})(),s.clearRect(0,0,i.width,i.height),(!e(S)||e(S)&&Math.floor(e(B)*60/10)%2===0)&&c.draw(s);for(const r of e(z))r.draw(s);for(const r of e(b))r.draw(s);for(const r of e(m))r.draw(s);e(n)&&e(n).draw(s),H=requestAnimationFrame(x)};return H=requestAnimationFrame(x),()=>cancelAnimationFrame(H)});const ne=x=>{p[x.key.toLowerCase()]=!0},he=x=>{p[x.key.toLowerCase()]=!1};let W=v(!1),$=v(!1);function le(x){const E=i.width/2;x<E?(l(W,!0),l($,!1)):(l($,!0),l(W,!1))}const de=()=>{l(L,!0)},ce=()=>{l(L,!1),V=performance.now()};te(()=>(i&&(s=i.getContext("2d"),q(),c.x=i.width/2,c.y=i.height-80),window.addEventListener("keydown",ne),window.addEventListener("keyup",he),window.addEventListener("resize",q),window.addEventListener("blur",de),window.addEventListener("focus",ce),()=>{window.removeEventListener("keydown",ne),window.removeEventListener("keyup",he),window.removeEventListener("resize",q),window.removeEventListener("blur",de),window.removeEventListener("focus",ce)})),te(()=>{!e(g)||e(f)});function q(){const x=document.querySelector(".relative.max-w-lg");x&&(i.width=x.offsetWidth,i.height=x.offsetHeight)}const Se=He(()=>e(n)?e(n).health/e(n).maxHealth*100:0);var A=tt();ke(x=>{var E=Ke();ye(x,E)}),A.__touchstart=[$e,g,f,G,le],A.__touchmove=[qe,g,f,le],A.__touchend=[Ue,W,$];var U=R(A),fe=R(U);je(fe,x=>i=x,()=>i);var K=M(fe,2),J=R(K),ze=R(J);P(J);var ue=M(J,2),Ee=R(ue);P(ue),P(K);var j=M(K,2);let pe;var Ie=R(j);let xe;P(j);var F=M(j,2);let ge;var Le=M(R(F),4);Le.__click=G,P(F);var Q=M(F,2);let ve;var Z=M(R(Q),2),Be=R(Z);P(Z);var Ae=M(Z,2);Ae.__click=G,P(Q),P(U);var we=M(U,2),ee=R(we);ee.__touchstart=[Je,p],ee.__touchend=[Qe,p];var me=M(ee,2);me.__touchstart=[Ze,p],me.__touchend=[et,p],P(we),P(A),Ce((x,E,w,X)=>{se(ze,`スコア: ${e(a)??""}`),se(Ee,`残機: ${e(h)??""}`),pe=re(j,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,pe,x),xe=De(Ie,"",xe,E),ge=re(F,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ge,w),ve=re(Q,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ve,X),se(Be,`最終スコア: ${e(a)??""}`)},[()=>({hidden:!e(n)}),()=>({width:`${e(Se)}%`}),()=>({hidden:e(g)}),()=>({hidden:!e(f)})]),ye(o,A),Oe()}Ve(["touchstart","touchmove","touchend","click"]);export{nt as component};
