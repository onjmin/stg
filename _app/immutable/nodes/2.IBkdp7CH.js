import"../chunks/DsnmJJEf.js";import{o as $,_ as Yt,as as k,aC as _,u as xt,aa as t,at as d,aG as et,a5 as _t,a2 as kt,af as R,ad as S,a6 as Ct,a4 as vt,$ as jt,ae as E,aD as Ht}from"../chunks/CYXQVpue.js";import{d as Nt,s as it}from"../chunks/q5wOSprp.js";import{b as Gt}from"../chunks/DOpaPJET.js";const mt=[...` 	
\r\f \v\uFEFF`];function Vt(n,e,i){var r=n==null?"":""+n;if(i){for(var o in i)if(i[o])r=r?r+" "+o:o;else if(r.length)for(var l=o.length,f=0;(f=r.indexOf(o,f))>=0;){var m=f+l;(f===0||mt.includes(r[f-1]))&&(m===r.length||mt.includes(r[m]))?r=(f===0?"":r.substring(0,f))+r.substring(m+1):f=m}}return r===""?null:r}function wt(n,e=!1){var i=e?" !important;":";",r="";for(var o in n){var l=n[o];l!=null&&l!==""&&(r+=" "+o+": "+l+i)}return r}function $t(n,e){if(e){var i="",r,o;return Array.isArray(e)?(r=e[0],o=e[1]):r=e,r&&(i+=wt(r)),o&&(i+=wt(o,!0)),i=i.trim(),i===""?null:i}return String(n)}function st(n,e,i,r,o,l){var f=n.__className;if($||f!==i||f===void 0){var m=Vt(i,r,l);(!$||m!==n.getAttribute("class"))&&(m==null?n.removeAttribute("class"):n.className=m),n.__className=i}else if(l&&o!==l)for(var g in l){var M=!!l[g];(o==null||M!==!!o[g])&&n.classList.toggle(g,M)}return l}function rt(n,e={},i,r){for(var o in i){var l=i[o];e[o]!==l&&(i[o]==null?n.style.removeProperty(o):n.style.setProperty(o,l,r))}}function Ft(n,e,i,r){var o=n.__style;if($||o!==e){var l=$t(e,r);(!$||l!==n.getAttribute("style"))&&(l==null?n.removeAttribute("style"):n.style.cssText=l),n.__style=e}else r&&(Array.isArray(r)?(rt(n,i?.[0],r[0]),rt(n,i?.[1],r[1],"important")):rt(n,i,r));return r}class Ut{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;draw(e){e.beginPath(),e.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),e.fillStyle="#4299e1",e.fill(),e.closePath()}}class X{x;y;direction;owner;color;speed;size;constructor(e,i,r,o,l="#f6e05e",f=7,m=5){this.x=e,this.y=i,this.direction=r,this.owner=o,this.color=l,this.speed=f,this.size=m}update(e){typeof this.direction=="object"?(this.x+=this.direction.x*this.speed*60*e,this.y+=this.direction.y*this.speed*60*e):(this.x+=Math.cos(this.direction)*this.speed*60*e,this.y+=Math.sin(this.direction)*this.speed*60*e)}draw(e){e.beginPath(),e.arc(this.x,this.y,this.size,0,Math.PI*2),e.fillStyle=this.color,e.fill(),e.closePath()}}class at{x;y;health;scoreValue;width=30;height=30;color;speed=4;hitboxRadius=10;fireTimer=0;constructor(e,i,r,o,l="#e53e3e"){this.x=e,this.y=i,this.health=r,this.scoreValue=o,this.color=l}update(e){this.y+=this.speed*60*e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath()}}class yt extends at{fireRate=1;constructor(e,i,r,o,l){super(e,i,r,o,l)}}class bt extends at{fireRate=1.5;constructor(e,i,r,o,l){super(e,i,r,o,l)}}class Wt extends at{targetX;fireTimer=0;patterns=[{time:1,type:"spread",speed:4},{time:2,type:"circular",speed:2},{time:3,type:"spiral",speed:2},{time:4,type:"random",speed:6}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor(e,i,r,o){super(e,i,r,o,"#f56565"),this.targetX=e,this.maxHealth=r}update(e){this.x+=(this.targetX-this.x)*this.speed*60*e,this.fireTimer+=e,this.patternTimer+=e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath();const i=this.width,r=10,o=this.x-i/2,l=this.y-this.height/2-r-5;e.fillStyle="#333",e.fillRect(o,l,i,r);const f=this.health/this.maxHealth*i;e.fillStyle="#27ae60",e.fillRect(o,l,f,r)}}function qt(){}var Dt=_t('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Ot=(n,e)=>{e.a=!0},Kt=(n,e)=>{e.a=!1},Jt=(n,e)=>{e.d=!0},Qt=(n,e)=>{e.d=!1},Zt=_t(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div> <div class="md:hidden absolute bottom-5 w-full flex justify-center gap-5"><button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">◀</button> <button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">▶</button></div></div>`);function ae(n,e){Yt(e,!0);let i,r,o=_(0),l=_(3),f=_(!1),m=_(!1),g=k({}),M=_(!1),A=_(0);const Mt=4;let h=k(new Ut),P=_(k([])),z=_(k([])),y=_(k([])),a=_(null),Y=_(0),C=_(0);const F=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],Tt="ontouchstart"in globalThis||navigator.maxTouchPoints>0,U=()=>{d(m,!0),d(f,!1),d(o,0),d(l,3),d(P,[],!0),d(z,[],!0),d(y,[],!0),d(a,null),d(Y,0),d(C,0),d(M,!1),d(A,0),i&&(h.x=i.width/2,h.y=i.height-80),q=performance.now()};let W,q=0;xt(()=>{if(!t(m)||t(f))return;const u=I=>{const x=(I-q)/1e3;if(q=I,d(C,t(C)+x),!Tt){const s=g.shift?h.speed/2:h.speed;(g.arrowleft||g.a)&&(h.x-=s*60*x),(g.arrowright||g.d)&&(h.x+=s*60*x),(g.arrowup||g.w)&&(h.y-=s*60*x),(g.arrowdown||g.s)&&(h.y+=s*60*x),h.x=Math.max(h.hitboxRadius,Math.min(h.x,i.width-h.hitboxRadius)),h.y=Math.max(h.hitboxRadius,Math.min(h.y,i.height-h.hitboxRadius))}if(h.fireTimer+=x,h.fireTimer>=h.fireRate&&(t(z).push(new X(h.x,h.y,{x:0,y:-1},"player")),h.fireTimer=0),t(M)&&(d(A,t(A)+x),t(A)>=Mt&&(d(M,!1),d(A,0))),d(z,t(z).filter(s=>(s.update(x),s.y>-s.size)),!0),d(y,t(y).filter(s=>(s.update(x),s.y<i.height+s.size&&s.x>-s.size&&s.x<i.width+s.size)),!0),t(P).forEach(s=>{s.y+=s.speed*60*x,s.fireTimer+=x,s instanceof yt?s.fireTimer>=s.fireRate&&(t(y).push(new X(s.x,s.y+s.height,{x:0,y:1},"enemy","#a0aec0")),s.fireTimer=0):s instanceof bt&&s.fireTimer>=s.fireRate&&([-30,-15,0,15,30].forEach(T=>{const w=T*Math.PI/180,c=Math.sin(w)*3,v=Math.cos(w)*3;t(y).push(new X(s.x,s.y+s.height,{x:c,y:v},"enemy","#a0aec0"))}),s.fireTimer=0)}),d(P,t(P).filter(s=>s.y<i.height+s.height),!0),t(Y)<F.length){const s=F[t(Y)];t(C)>=s.time&&(s.type==="straight"?t(P).push(new yt(s.x,-50,10,10)):s.type==="spread"&&t(P).push(new bt(s.x,-50,15,20)),et(Y))}if(t(Y)>=F.length&&t(P).length===0&&!t(a)&&d(a,new Wt(i.width/2,100,500,1e3),!0),t(a)){t(a).update(x),Math.abs(t(a).x-t(a).targetX)<5&&(t(a).targetX=Math.random()*(i.width-t(a).width)+t(a).width/2);const s=t(a).patterns[t(a).currentPatternIndex];if(t(a).patternTimer>=s.time&&(t(a).currentPatternIndex=(t(a).currentPatternIndex+1)%t(a).patterns.length,t(a).patternTimer=0),t(a).fireTimer>=.5){const p=s.speed;switch(s.type){case"spread":for(let T=-2;T<=2;T++){const c=T*15*Math.PI/180,v=Math.sin(c)*p,b=Math.cos(c)*p;t(y).push(new X(t(a).x,t(a).y+t(a).height/2,{x:v,y:b},"enemy","#ecc94b",p,8))}break;case"circular":{for(let w=0;w<12;w++){const c=w/12*Math.PI*2,v=Math.sin(c)*p,b=Math.cos(c)*p;t(y).push(new X(t(a).x,t(a).y+t(a).height/2,{x:v,y:b},"enemy","#ecc94b",p,6))}break}case"spiral":{const w=t(a).fireTimer;for(let c=0;c<8;c++){const v=c/8*Math.PI*2+w,b=Math.sin(v)*p,B=Math.cos(v)*p;t(y).push(new X(t(a).x,t(a).y+t(a).height/2,{x:b,y:B},"enemy","#ecc94b",p,6))}break}case"random":Math.random()>.5&&t(y).push(new X(t(a).x,t(a).y+t(a).height/2,{x:Math.random()*2-1,y:1},"enemy","#ecc94b",p,6));break}t(a).fireTimer=0}}(()=>{const s=[...t(z)],p=[...t(P)],T=[...t(y)];let w=t(o);s.forEach((c,v)=>{let b=!1;p.forEach((B,Lt)=>{Math.hypot(c.x-B.x,c.y-B.y)<B.hitboxRadius+c.size&&(b=!0,B.health-=1,B.health<=0&&(w+=B.scoreValue,p.splice(Lt,1)))}),t(a)&&!b&&Math.hypot(c.x-t(a).x,c.y-t(a).y)<t(a).hitboxRadius+c.size&&(b=!0,t(a).health-=1,t(a).health<=0&&(w+=t(a).scoreValue,d(a,null))),b||s.splice(v,1)}),t(M)?p.forEach((c,v)=>{c.y>i.height&&p.splice(v,1)}):(p.forEach((c,v)=>{Math.hypot(c.x-h.x,c.y-h.y)<h.hitboxRadius+c.hitboxRadius?(et(l,-1),t(l)<=0?d(f,!0):d(M,!0),p.splice(v,1)):c.y>i.height&&p.splice(v,1)}),T.forEach((c,v)=>{Math.hypot(c.x-h.x,c.y-h.y)<h.hitboxRadius+c.size&&(T.splice(v,1),et(l,-1),t(l)<=0?d(f,!0):d(M,!0))})),d(z,s,!0),d(P,p,!0),d(y,T,!0),d(o,w,!0)})(),r.clearRect(0,0,i.width,i.height),(!t(M)||t(M)&&Math.floor(t(A)*60/10)%2===0)&&h.draw(r);for(const s of t(z))s.draw(r);for(const s of t(P))s.draw(r);for(const s of t(y))s.draw(r);t(a)&&t(a).draw(r),W=requestAnimationFrame(u)};return W=requestAnimationFrame(u),()=>cancelAnimationFrame(W)});const ot=u=>{g[u.key.toLowerCase()]=!0},nt=u=>{g[u.key.toLowerCase()]=!1};let j=0,H=0;function Pt(u){!t(m)||t(f)?U():(j=u.touches[0].clientX,H=u.touches[0].clientY,h.x=j,h.y=H)}function Rt(u){if(!t(m)||t(f))return;const I=u.touches[0].clientX,x=u.touches[0].clientY,V=I-j,s=x-H;h.x+=V,h.y+=s,j=I,H=x}xt(()=>(i&&(r=i.getContext("2d"),D(),h.x=i.width/2,h.y=i.height-80),window.addEventListener("keydown",ot),window.addEventListener("keyup",nt),window.addEventListener("resize",D),()=>{window.removeEventListener("keydown",ot),window.removeEventListener("keyup",nt),window.removeEventListener("resize",D)}));function D(){const u=document.querySelector(".relative.max-w-lg");u&&(i.width=u.offsetWidth,i.height=u.offsetHeight)}const St=Ht(()=>t(a)?t(a).health/t(a).maxHealth*100:0);var L=Zt();kt(u=>{var I=Dt();vt(u,I)}),L.__touchstart=Pt,L.__touchmove=Rt,L.__touchend=[qt];var O=S(L),lt=S(O);Gt(lt,u=>i=u,()=>i);var K=R(lt,2),J=S(K),Et=S(J);E(J);var ht=R(J,2),It=S(ht);E(ht),E(K);var N=R(K,2);let ct;var Bt=S(N);let dt;E(N);var G=R(N,2);let ft;var zt=R(S(G),4);zt.__click=U,E(G);var Q=R(G,2);let ut;var Z=R(S(Q),2),Xt=S(Z);E(Z);var At=R(Z,2);At.__click=U,E(Q),E(O);var pt=R(O,2),tt=S(pt);tt.__touchstart=[Ot,g],tt.__touchend=[Kt,g];var gt=R(tt,2);gt.__touchstart=[Jt,g],gt.__touchend=[Qt,g],E(pt),E(L),Ct((u,I,x,V)=>{it(Et,`スコア: ${t(o)??""}`),it(It,`残機: ${t(l)??""}`),ct=st(N,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,ct,u),dt=Ft(Bt,"",dt,I),ft=st(G,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ft,x),ut=st(Q,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ut,V),it(Xt,`最終スコア: ${t(o)??""}`)},[()=>({hidden:!t(a)}),()=>({width:`${t(St)}%`}),()=>({hidden:t(m)}),()=>({hidden:!t(f)})]),vt(n,L),jt()}Nt(["touchstart","touchmove","touchend","click"]);export{ae as component};
