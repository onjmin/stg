import"../chunks/DsnmJJEf.js";import{o as D,_ as Xe,as as C,aC as m,u as xe,aa as e,at as c,aG as Q,a5 as be,a2 as Ae,af as I,a6 as Ye,a4 as ge,$ as ke,ad as R,ae as S,aD as Ce}from"../chunks/CYXQVpue.js";import{d as Oe,s as Z}from"../chunks/q5wOSprp.js";import{b as He}from"../chunks/DOpaPJET.js";const ve=[...` 	
\r\f \v\uFEFF`];function Ve(h,t,i){var s=h==null?"":""+h;if(i){for(var a in i)if(i[a])s=s?s+" "+a:a;else if(s.length)for(var n=a.length,f=0;(f=s.indexOf(a,f))>=0;){var x=f+n;(f===0||ve.includes(s[f-1]))&&(x===s.length||ve.includes(s[x]))?s=(f===0?"":s.substring(0,f))+s.substring(x+1):f=x}}return s===""?null:s}function me(h,t=!1){var i=t?" !important;":";",s="";for(var a in h){var n=h[a];n!=null&&n!==""&&(s+=" "+a+": "+n+i)}return s}function Fe(h,t){if(t){var i="",s,a;return Array.isArray(t)?(s=t[0],a=t[1]):s=t,s&&(i+=me(s)),a&&(i+=me(a,!0)),i=i.trim(),i===""?null:i}return String(h)}function ee(h,t,i,s,a,n){var f=h.__className;if(D||f!==i||f===void 0){var x=Ve(i,s,n);(!D||x!==h.getAttribute("class"))&&(x==null?h.removeAttribute("class"):h.className=x),h.__className=i}else if(n&&a!==n)for(var v in n){var B=!!n[v];(a==null||B!==!!a[v])&&h.classList.toggle(v,B)}return n}function te(h,t={},i,s){for(var a in i){var n=i[a];t[a]!==n&&(i[a]==null?h.style.removeProperty(a):h.style.setProperty(a,n,s))}}function Ne(h,t,i,s){var a=h.__style;if(D||a!==t){var n=Fe(t,s);(!D||n!==h.getAttribute("style"))&&(n==null?h.removeAttribute("style"):h.style.cssText=n),h.__style=t}else s&&(Array.isArray(s)?(te(h,i?.[0],s[0]),te(h,i?.[1],s[1],"important")):te(h,i,s));return s}class De{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;draw(t){t.beginPath(),t.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),t.fillStyle="#4299e1",t.fill(),t.closePath()}}class _{x;y;direction;owner;color;speed;size;constructor({x:t,y:i,direction:s,owner:a,color:n="#f6e05e",speed:f=7,size:x=5}){this.x=t,this.y=i,this.direction=s,this.owner=a,this.color=n,this.speed=f,this.size=x}update(t){this.x+=this.direction.x*this.speed*60*t,this.y+=this.direction.y*this.speed*60*t}draw(t){t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.closePath()}}class ie{x;y;health;scoreValue;width=30;height=30;color;speed=4;hitboxRadius=10;fireTimer=0;constructor({x:t,y:i,health:s,scoreValue:a,color:n="#e53e3e"}){this.x=t,this.y=i,this.health=s,this.scoreValue=a,this.color=n}update(t){this.y+=this.speed*60*t}draw(t){t.beginPath(),t.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),t.fillStyle=this.color,t.fill(),t.closePath()}}class we extends ie{fireRate=1;constructor({x:t,y:i,health:s,scoreValue:a,color:n}){super({x:t,y:i,health:s,scoreValue:a,color:n})}}class ye extends ie{fireRate=1.5;constructor({x:t,y:i,health:s,scoreValue:a,color:n}){super({x:t,y:i,health:s,scoreValue:a,color:n})}}class Ge extends ie{targetX;targetY;moveOffset={x:0,y:0};fireTimer=0;patterns=[{time:1,type:"spread",speed:4,moveOffset:{x:.5,y:-.5}},{time:2,type:"circular",speed:2,moveOffset:{x:-.5,y:.5}},{time:3,type:"spiral",speed:2,moveOffset:{x:.8,y:.8}},{time:4,type:"random",speed:6,moveOffset:{x:-.8,y:-.8}}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor({x:t,y:i,health:s,scoreValue:a}){super({x:t,y:i,health:s,scoreValue:a,color:"#f56565"}),this.targetX=t,this.targetY=i,this.maxHealth=s}update(t,i,s){const a=this.patterns[this.currentPatternIndex],n=(a.moveOffset.x+1)/2,f=(a.moveOffset.y+1)/2;this.targetX=n*(i-this.width),this.targetY=f*(s*.4-this.height),this.targetX+=this.width/2,this.targetY+=this.height/2,this.x+=(this.targetX-this.x)*this.speed*t,this.y+=(this.targetY-this.y)*this.speed*t,this.fireTimer+=t,this.patternTimer+=t}draw(t){t.beginPath(),t.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),t.fillStyle=this.color,t.fill(),t.closePath();const i=this.width,s=10,a=this.x-i/2,n=this.y-this.height/2-s-5;t.fillStyle="#333",t.fillRect(a,n,i,s);const f=this.health/this.maxHealth*i;t.fillStyle="#27ae60",t.fillRect(a,n,f,s)}}function $e(h,t){c(t,!1)}var je=be('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),qe=be(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面を指でなぞって移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div></div>`);function Ze(h,t){Xe(t,!0);let i,s,a=m(0),n=m(3),f=m(!1),x=m(!1),v=C({}),B=m(!1),z=m(!1),L=m(0);const Te=4;let d=C(new De),b=m(C([])),E=m(C([])),w=m(C([])),o=m(null),Y=m(0),O=m(0);const G=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],$=()=>{c(x,!0),c(f,!1),c(a,0),c(n,3),c(b,[],!0),c(E,[],!0),c(w,[],!0),c(o,null),c(Y,0),c(O,0),c(z,!1),c(L,0),i&&(d.x=i.width/2,d.y=i.height-80),V=performance.now()};let H,V=0;xe(()=>{if(!e(x)||e(f))return;const u=M=>{const g=(M-V)/1e3;if(V=M,e(B)){H=requestAnimationFrame(u);return}c(O,e(O)+g);const A=v.shift?d.speed/2:d.speed;if((v.arrowleft||v.a)&&(d.x-=A*60*g),(v.arrowright||v.d)&&(d.x+=A*60*g),(v.arrowup||v.w)&&(d.y-=A*60*g),(v.arrowdown||v.s)&&(d.y+=A*60*g),d.x=Math.max(d.hitboxRadius,Math.min(d.x,i.width-d.hitboxRadius)),d.y=Math.max(d.hitboxRadius,Math.min(d.y,i.height-d.hitboxRadius)),d.fireTimer+=g,d.fireTimer>=d.fireRate&&(e(E).push(new _({x:d.x,y:d.y,direction:{x:0,y:-1},owner:"player"})),d.fireTimer=0),e(z)&&(c(L,e(L)+g),e(L)>=Te&&(c(z,!1),c(L,0))),c(E,e(E).filter(r=>(r.update(g),r.y>-r.size)),!0),c(w,e(w).filter(r=>(r.update(g),r.y<i.height+r.size&&r.x>-r.size&&r.x<i.width+r.size)),!0),e(b).forEach(r=>{r.y+=r.speed*60*g,r.fireTimer+=g,r instanceof we?r.fireTimer>=r.fireRate&&(e(w).push(new _({x:r.x,y:r.y+r.height,direction:{x:0,y:1},owner:"enemy",color:"#a0aec0"})),r.fireTimer=0):r instanceof ye&&r.fireTimer>=r.fireRate&&([-30,-15,0,15,30].forEach(T=>{const l=T*Math.PI/180,p=Math.sin(l),P=Math.cos(l);e(w).push(new _({x:r.x,y:r.y+r.height,direction:{x:p,y:P},owner:"enemy",color:"#a0aec0"}))}),r.fireTimer=0)}),c(b,e(b).filter(r=>r.y<i.height+r.height),!0),e(Y)<G.length){const r=G[e(Y)];e(O)>=r.time&&(r.type==="straight"?e(b).push(new we({x:r.x,y:-50,health:10,scoreValue:10})):r.type==="spread"&&e(b).push(new ye({x:r.x,y:-50,health:15,scoreValue:20})),Q(Y))}if(e(Y)>=G.length&&e(b).length===0&&!e(o)&&c(o,new Ge({x:i.width/2,y:100,health:500,scoreValue:1e3}),!0),e(o)){e(o).update(g,i.width,i.height);const r=e(o).patterns[e(o).currentPatternIndex];if(e(o).patternTimer>=r.time&&(e(o).currentPatternIndex=(e(o).currentPatternIndex+1)%e(o).patterns.length,e(o).patternTimer=0),e(o).fireTimer>=.5){const y=r.speed;switch(r.type){case"spread":for(let T=-2;T<=2;T++){const p=T*15*Math.PI/180,P=Math.sin(p),k=Math.cos(p);e(w).push(new _({x:e(o).x,y:e(o).y+e(o).height/2,direction:{x:P,y:k},owner:"enemy",color:"#ecc94b",speed:y,size:8}))}break;case"circular":{for(let l=0;l<12;l++){const p=l/12*Math.PI*2,P=Math.sin(p)*y,k=Math.cos(p)*y;e(w).push(new _({x:e(o).x,y:e(o).y+e(o).height/2,direction:{x:P,y:k},owner:"enemy",color:"#ecc94b",speed:y,size:6}))}break}case"spiral":{const l=e(o).fireTimer;for(let p=0;p<8;p++){const P=p/8*Math.PI*2+l,k=Math.sin(P)*y,Le=Math.cos(P)*y;e(w).push(new _({x:e(o).x,y:e(o).y+e(o).height/2,direction:{x:k,y:Le},owner:"enemy",color:"#ecc94b",speed:y,size:6}))}break}case"random":Math.random()>.5&&e(w).push(new _({x:e(o).x,y:e(o).y+e(o).height/2,direction:{x:Math.random()*2-1,y:1},owner:"enemy",color:"#ecc94b",speed:y,size:6}));break}e(o).fireTimer=0}}(()=>{const r=new Set,y=new Set;let T=e(a);e(E).forEach(l=>{e(b).forEach(p=>{Math.hypot(l.x-p.x,l.y-p.y)<p.hitboxRadius+l.size&&(r.add(l),y.add(p),p.health-=1,p.health<=0&&(T+=p.scoreValue))}),e(o)&&Math.hypot(l.x-e(o).x,l.y-e(o).y)<e(o).hitboxRadius+l.size&&(r.add(l),e(o).health-=1,e(o).health<=0&&(T+=e(o).scoreValue))}),e(z)||(e(w).forEach(l=>{Math.hypot(l.x-d.x,l.y-d.y)<d.hitboxRadius+l.size&&(r.add(l),Q(n,-1),e(n)<=0?c(f,!0):c(z,!0))}),e(b).forEach(l=>{Math.hypot(l.x-d.x,l.y-d.y)<d.hitboxRadius+l.hitboxRadius&&(Q(n,-1),e(n)<=0?c(f,!0):c(z,!0),y.add(l))})),c(E,e(E).filter(l=>!r.has(l)),!0),c(b,e(b).filter(l=>l.health>0&&!y.has(l)),!0),c(w,e(w).filter(l=>!r.has(l)),!0),c(a,T,!0)})(),s.clearRect(0,0,i.width,i.height),(!e(z)||e(z)&&Math.floor(e(L)*60/10)%2===0)&&d.draw(s);for(const r of e(E))r.draw(s);for(const r of e(b))r.draw(s);for(const r of e(w))r.draw(s);e(o)&&e(o).draw(s),H=requestAnimationFrame(u)};return H=requestAnimationFrame(u),()=>cancelAnimationFrame(H)});const se=u=>{v[u.key.toLowerCase()]=!0},re=u=>{v[u.key.toLowerCase()]=!1};let j=0,ae=m(!1);function Me(u){if(!e(x)||e(f)){$();return}u.preventDefault(),c(ae,!0),j=u.touches[0].clientX}function Pe(u){if(!e(x)||e(f))return;u.preventDefault();const M=u.touches[0].clientX,g=M-j;d.x+=g,j=M}const oe=()=>{c(B,!0)},ne=()=>{c(B,!1),V=performance.now()};xe(()=>(i&&(s=i.getContext("2d"),q(),d.x=i.width/2,d.y=i.height-80),window.addEventListener("keydown",se),window.addEventListener("keyup",re),window.addEventListener("resize",q),window.addEventListener("blur",oe),window.addEventListener("focus",ne),()=>{window.removeEventListener("keydown",se),window.removeEventListener("keyup",re),window.removeEventListener("resize",q),window.removeEventListener("blur",oe),window.removeEventListener("focus",ne)}));function q(){const u=document.querySelector(".relative.max-w-lg");u&&(i.width=u.offsetWidth,i.height=u.offsetHeight)}const Re=Ce(()=>e(o)?e(o).health/e(o).maxHealth*100:0);var X=qe();Ae(u=>{var M=je();ge(u,M)}),X.__touchstart=Me,X.__touchmove=Pe,X.__touchend=[$e,ae];var he=R(X),le=R(he);He(le,u=>i=u,()=>i);var U=I(le,2),W=R(U),Se=R(W);S(W);var de=I(W,2),ze=R(de);S(de),S(U);var F=I(U,2);let ce;var Ee=R(F);let fe;S(F);var N=I(F,2);let ue;var Ie=I(R(N),4);Ie.__click=$,S(N);var K=I(N,2);let pe;var J=I(R(K),2),_e=R(J);S(J);var Be=I(J,2);Be.__click=$,S(K),S(he),S(X),Ye((u,M,g,A)=>{Z(Se,`スコア: ${e(a)??""}`),Z(ze,`残機: ${e(n)??""}`),ce=ee(F,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,ce,u),fe=Ne(Ee,"",fe,M),ue=ee(N,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ue,g),pe=ee(K,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,pe,A),Z(_e,`最終スコア: ${e(a)??""}`)},[()=>({hidden:!e(o)}),()=>({width:`${e(Re)}%`}),()=>({hidden:e(x)}),()=>({hidden:!e(f)})]),ge(h,X),ke()}Oe(["touchstart","touchmove","touchend","click"]);export{Ze as component};
