import"../chunks/DsnmJJEf.js";import{o as N,_ as At,as as L,aC as b,u as xt,aa as t,at as d,aG as tt,a5 as bt,a2 as Lt,af as M,ad as P,a6 as kt,a4 as gt,$ as Ct,ae as R,aD as Ot}from"../chunks/CYXQVpue.js";import{d as Ht,s as et}from"../chunks/q5wOSprp.js";import{b as Vt}from"../chunks/DOpaPJET.js";const vt=[...` 	
\r\f \v\uFEFF`];function jt(h,e,i){var r=h==null?"":""+h;if(i){for(var a in i)if(i[a])r=r?r+" "+a:a;else if(r.length)for(var n=a.length,f=0;(f=r.indexOf(a,f))>=0;){var v=f+n;(f===0||vt.includes(r[f-1]))&&(v===r.length||vt.includes(r[v]))?r=(f===0?"":r.substring(0,f))+r.substring(v+1):f=v}}return r===""?null:r}function mt(h,e=!1){var i=e?" !important;":";",r="";for(var a in h){var n=h[a];n!=null&&n!==""&&(r+=" "+a+": "+n+i)}return r}function Nt(h,e){if(e){var i="",r,a;return Array.isArray(e)?(r=e[0],a=e[1]):r=e,r&&(i+=mt(r)),a&&(i+=mt(a,!0)),i=i.trim(),i===""?null:i}return String(h)}function it(h,e,i,r,a,n){var f=h.__className;if(N||f!==i||f===void 0){var v=jt(i,r,n);(!N||v!==h.getAttribute("class"))&&(v==null?h.removeAttribute("class"):h.className=v),h.__className=i}else if(n&&a!==n)for(var x in n){var _=!!n[x];(a==null||_!==!!a[x])&&h.classList.toggle(x,_)}return n}function st(h,e={},i,r){for(var a in i){var n=i[a];e[a]!==n&&(i[a]==null?h.style.removeProperty(a):h.style.setProperty(a,n,r))}}function Gt(h,e,i,r){var a=h.__style;if(N||a!==e){var n=Nt(e,r);(!N||n!==h.getAttribute("style"))&&(n==null?h.removeAttribute("style"):h.style.cssText=n),h.__style=e}else r&&(Array.isArray(r)?(st(h,i?.[0],r[0]),st(h,i?.[1],r[1],"important")):st(h,i,r));return r}class $t{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;draw(e){e.beginPath(),e.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),e.fillStyle="#4299e1",e.fill(),e.closePath()}}class Y{x;y;direction;owner;color;speed;size;constructor({x:e,y:i,direction:r,owner:a,color:n="#f6e05e",speed:f=7,size:v=5}){this.x=e,this.y=i,this.direction=r,this.owner=a,this.color=n,this.speed=f,this.size=v}update(e){this.x+=this.direction.x*this.speed*60*e,this.y+=this.direction.y*this.speed*60*e}draw(e){e.beginPath(),e.arc(this.x,this.y,this.size,0,Math.PI*2),e.fillStyle=this.color,e.fill(),e.closePath()}}class rt{x;y;health;scoreValue;width=30;height=30;color;speed=4;hitboxRadius=10;fireTimer=0;constructor({x:e,y:i,health:r,scoreValue:a,color:n="#e53e3e"}){this.x=e,this.y=i,this.health=r,this.scoreValue=a,this.color=n}update(e){this.y+=this.speed*60*e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath()}}class wt extends rt{fireRate=1;constructor({x:e,y:i,health:r,scoreValue:a,color:n}){super({x:e,y:i,health:r,scoreValue:a,color:n})}}class yt extends rt{fireRate=1.5;constructor({x:e,y:i,health:r,scoreValue:a,color:n}){super({x:e,y:i,health:r,scoreValue:a,color:n})}}class Ft extends rt{targetX;targetY;moveOffset={x:0,y:0};fireTimer=0;patterns=[{time:1,type:"spread",speed:4,moveOffset:{x:.5,y:-.5}},{time:2,type:"circular",speed:2,moveOffset:{x:-.5,y:.5}},{time:3,type:"spiral",speed:2,moveOffset:{x:.8,y:.8}},{time:4,type:"random",speed:6,moveOffset:{x:-.8,y:-.8}}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor({x:e,y:i,health:r,scoreValue:a}){super({x:e,y:i,health:r,scoreValue:a,color:"#f56565"}),this.targetX=e,this.targetY=i,this.maxHealth=r}update(e,i,r){const a=this.patterns[this.currentPatternIndex],n=(a.moveOffset.x+1)/2,f=(a.moveOffset.y+1)/2;this.targetX=n*(i-this.width),this.targetY=f*(r*.4-this.height),this.targetX+=this.width/2,this.targetY+=this.height/2,this.x+=(this.targetX-this.x)*this.speed*e,this.y+=(this.targetY-this.y)*this.speed*e,this.fireTimer+=e,this.patternTimer+=e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath();const i=this.width,r=10,a=this.x-i/2,n=this.y-this.height/2-r-5;e.fillStyle="#333",e.fillRect(a,n,i,r);const f=this.health/this.maxHealth*i;e.fillStyle="#27ae60",e.fillRect(a,n,f,r)}}function Ut(){}var Wt=bt('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),qt=(h,e)=>{e.a=!0},Dt=(h,e)=>{e.a=!1},Kt=(h,e)=>{e.d=!0},Jt=(h,e)=>{e.d=!1},Qt=bt(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div> <div class="md:hidden absolute bottom-5 w-full flex justify-center gap-5"><button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">◀</button> <button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">▶</button></div></div>`);function se(h,e){At(e,!0);let i,r,a=b(0),n=b(3),f=b(!1),v=b(!1),x=L({}),_=b(!1),E=b(0);const _t=4;let l=L(new $t),y=b(L([])),I=b(L([])),m=b(L([])),o=b(null),B=b(0),k=b(0);const G=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],Tt="ontouchstart"in globalThis||navigator.maxTouchPoints>0,$=()=>{d(v,!0),d(f,!1),d(a,0),d(n,3),d(y,[],!0),d(I,[],!0),d(m,[],!0),d(o,null),d(B,0),d(k,0),d(_,!1),d(E,0),i&&(l.x=i.width/2,l.y=i.height-80),U=performance.now()};let F,U=0;xt(()=>{if(!t(v)||t(f))return;const u=S=>{const g=(S-U)/1e3;if(U=S,d(k,t(k)+g),!Tt){const s=x.shift?l.speed/2:l.speed;(x.arrowleft||x.a)&&(l.x-=s*60*g),(x.arrowright||x.d)&&(l.x+=s*60*g),(x.arrowup||x.w)&&(l.y-=s*60*g),(x.arrowdown||x.s)&&(l.y+=s*60*g),l.x=Math.max(l.hitboxRadius,Math.min(l.x,i.width-l.hitboxRadius)),l.y=Math.max(l.hitboxRadius,Math.min(l.y,i.height-l.hitboxRadius))}if(l.fireTimer+=g,l.fireTimer>=l.fireRate&&(t(I).push(new Y({x:l.x,y:l.y,direction:{x:0,y:-1},owner:"player"})),l.fireTimer=0),t(_)&&(d(E,t(E)+g),t(E)>=_t&&(d(_,!1),d(E,0))),d(I,t(I).filter(s=>(s.update(g),s.y>-s.size)),!0),d(m,t(m).filter(s=>(s.update(g),s.y<i.height+s.size&&s.x>-s.size&&s.x<i.width+s.size)),!0),t(y).forEach(s=>{s.y+=s.speed*60*g,s.fireTimer+=g,s instanceof wt?s.fireTimer>=s.fireRate&&(t(m).push(new Y({x:s.x,y:s.y+s.height,direction:{x:0,y:1},owner:"enemy",color:"#a0aec0"})),s.fireTimer=0):s instanceof yt&&s.fireTimer>=s.fireRate&&([-30,-15,0,15,30].forEach(T=>{const c=T*Math.PI/180,p=Math.sin(c),z=Math.cos(c);t(m).push(new Y({x:s.x,y:s.y+s.height,direction:{x:p,y:z},owner:"enemy",color:"#a0aec0"}))}),s.fireTimer=0)}),d(y,t(y).filter(s=>s.y<i.height+s.height),!0),t(B)<G.length){const s=G[t(B)];t(k)>=s.time&&(s.type==="straight"?t(y).push(new wt({x:s.x,y:-50,health:10,scoreValue:10})):s.type==="spread"&&t(y).push(new yt({x:s.x,y:-50,health:15,scoreValue:20})),tt(B))}if(t(B)>=G.length&&t(y).length===0&&!t(o)&&d(o,new Ft({x:i.width/2,y:100,health:500,scoreValue:1e3}),!0),t(o)){t(o).update(g,i.width,i.height);const s=t(o).patterns[t(o).currentPatternIndex];if(t(o).patternTimer>=s.time&&(t(o).currentPatternIndex=(t(o).currentPatternIndex+1)%t(o).patterns.length,t(o).patternTimer=0),t(o).fireTimer>=.5){const w=s.speed;switch(s.type){case"spread":for(let T=-2;T<=2;T++){const p=T*15*Math.PI/180,z=Math.sin(p),A=Math.cos(p);t(m).push(new Y({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:z,y:A},owner:"enemy",color:"#ecc94b",speed:w,size:8}))}break;case"circular":{for(let c=0;c<12;c++){const p=c/12*Math.PI*2,z=Math.sin(p)*w,A=Math.cos(p)*w;t(m).push(new Y({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:z,y:A},owner:"enemy",color:"#ecc94b",speed:w,size:6}))}break}case"spiral":{const c=t(o).fireTimer;for(let p=0;p<8;p++){const z=p/8*Math.PI*2+c,A=Math.sin(z)*w,Bt=Math.cos(z)*w;t(m).push(new Y({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:A,y:Bt},owner:"enemy",color:"#ecc94b",speed:w,size:6}))}break}case"random":Math.random()>.5&&t(m).push(new Y({x:t(o).x,y:t(o).y+t(o).height/2,direction:{x:Math.random()*2-1,y:1},owner:"enemy",color:"#ecc94b",speed:w,size:6}));break}t(o).fireTimer=0}}(()=>{const s=new Set,w=new Set;let T=t(a);t(I).forEach(c=>{t(y).forEach(p=>{Math.hypot(c.x-p.x,c.y-p.y)<p.hitboxRadius+c.size&&(s.add(c),w.add(p),p.health-=1,p.health<=0&&(T+=p.scoreValue))}),t(o)&&Math.hypot(c.x-t(o).x,c.y-t(o).y)<t(o).hitboxRadius+c.size&&(s.add(c),t(o).health-=1,t(o).health<=0&&(T+=t(o).scoreValue))}),t(_)||(t(m).forEach(c=>{Math.hypot(c.x-l.x,c.y-l.y)<l.hitboxRadius+c.size&&(s.add(c),tt(n,-1),t(n)<=0?d(f,!0):d(_,!0))}),t(y).forEach(c=>{Math.hypot(c.x-l.x,c.y-l.y)<l.hitboxRadius+c.hitboxRadius&&(tt(n,-1),t(n)<=0?d(f,!0):d(_,!0),w.add(c))})),d(I,t(I).filter(c=>!s.has(c)),!0),d(y,t(y).filter(c=>c.health>0&&!w.has(c)),!0),d(m,t(m).filter(c=>!s.has(c)),!0),d(a,T,!0)})(),r.clearRect(0,0,i.width,i.height),(!t(_)||t(_)&&Math.floor(t(E)*60/10)%2===0)&&l.draw(r);for(const s of t(I))s.draw(r);for(const s of t(y))s.draw(r);for(const s of t(m))s.draw(r);t(o)&&t(o).draw(r),F=requestAnimationFrame(u)};return F=requestAnimationFrame(u),()=>cancelAnimationFrame(F)});const at=u=>{x[u.key.toLowerCase()]=!0},ot=u=>{x[u.key.toLowerCase()]=!1};let C=0,O=0;function Mt(u){!t(v)||t(f)?$():(C=u.touches[0].clientX,O=u.touches[0].clientY,l.x=C,l.y=O)}function Pt(u){if(!t(v)||t(f))return;const S=u.touches[0].clientX,g=u.touches[0].clientY,j=S-C,s=g-O;l.x+=j,l.y+=s,C=S,O=g}xt(()=>(i&&(r=i.getContext("2d"),W(),l.x=i.width/2,l.y=i.height-80),window.addEventListener("keydown",at),window.addEventListener("keyup",ot),window.addEventListener("resize",W),()=>{window.removeEventListener("keydown",at),window.removeEventListener("keyup",ot),window.removeEventListener("resize",W)}));function W(){const u=document.querySelector(".relative.max-w-lg");u&&(i.width=u.offsetWidth,i.height=u.offsetHeight)}const Rt=Ot(()=>t(o)?t(o).health/t(o).maxHealth*100:0);var X=Qt();Lt(u=>{var S=Wt();gt(u,S)}),X.__touchstart=Mt,X.__touchmove=Pt,X.__touchend=[Ut];var q=P(X),nt=P(q);Vt(nt,u=>i=u,()=>i);var D=M(nt,2),K=P(D),St=P(K);R(K);var ht=M(K,2),zt=P(ht);R(ht),R(D);var H=M(D,2);let lt;var It=P(H);let ct;R(H);var V=M(H,2);let dt;var Yt=M(P(V),4);Yt.__click=$,R(V);var J=M(V,2);let ft;var Q=M(P(J),2),Et=P(Q);R(Q);var Xt=M(Q,2);Xt.__click=$,R(J),R(q);var ut=M(q,2),Z=P(ut);Z.__touchstart=[qt,x],Z.__touchend=[Dt,x];var pt=M(Z,2);pt.__touchstart=[Kt,x],pt.__touchend=[Jt,x],R(ut),R(X),kt((u,S,g,j)=>{et(St,`スコア: ${t(a)??""}`),et(zt,`残機: ${t(n)??""}`),lt=it(H,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,lt,u),ct=Gt(It,"",ct,S),dt=it(V,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,dt,g),ft=it(J,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ft,j),et(Et,`最終スコア: ${t(a)??""}`)},[()=>({hidden:!t(o)}),()=>({width:`${t(Rt)}%`}),()=>({hidden:t(v)}),()=>({hidden:!t(f)})]),gt(h,X),Ct()}Ht(["touchstart","touchmove","touchend","click"]);export{se as component};
