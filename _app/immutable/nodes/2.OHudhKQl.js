import"../chunks/DsnmJJEf.js";import{o as G,_ as Lt,as as Y,aC as b,u as xt,aa as t,at as d,aG as tt,a5 as bt,a2 as Yt,af as M,ad as P,a6 as kt,a4 as gt,$ as Ct,ae as R,aD as Ht}from"../chunks/CYXQVpue.js";import{d as Vt,s as et}from"../chunks/q5wOSprp.js";import{b as jt}from"../chunks/DOpaPJET.js";const vt=[...` 	
\r\f \v\uFEFF`];function Nt(n,e,r){var s=n==null?"":""+n;if(r){for(var o in r)if(r[o])s=s?s+" "+o:o;else if(s.length)for(var l=o.length,f=0;(f=s.indexOf(o,f))>=0;){var v=f+l;(f===0||vt.includes(s[f-1]))&&(v===s.length||vt.includes(s[v]))?s=(f===0?"":s.substring(0,f))+s.substring(v+1):f=v}}return s===""?null:s}function mt(n,e=!1){var r=e?" !important;":";",s="";for(var o in n){var l=n[o];l!=null&&l!==""&&(s+=" "+o+": "+l+r)}return s}function Gt(n,e){if(e){var r="",s,o;return Array.isArray(e)?(s=e[0],o=e[1]):s=e,s&&(r+=mt(s)),o&&(r+=mt(o,!0)),r=r.trim(),r===""?null:r}return String(n)}function it(n,e,r,s,o,l){var f=n.__className;if(G||f!==r||f===void 0){var v=Nt(r,s,l);(!G||v!==n.getAttribute("class"))&&(v==null?n.removeAttribute("class"):n.className=v),n.__className=r}else if(l&&o!==l)for(var x in l){var _=!!l[x];(o==null||_!==!!o[x])&&n.classList.toggle(x,_)}return l}function rt(n,e={},r,s){for(var o in r){var l=r[o];e[o]!==l&&(r[o]==null?n.style.removeProperty(o):n.style.setProperty(o,l,s))}}function $t(n,e,r,s){var o=n.__style;if(G||o!==e){var l=Gt(e,s);(!G||l!==n.getAttribute("style"))&&(l==null?n.removeAttribute("style"):n.style.cssText=l),n.__style=e}else s&&(Array.isArray(s)?(rt(n,r?.[0],s[0]),rt(n,r?.[1],s[1],"important")):rt(n,r,s));return s}class Ft{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;draw(e){e.beginPath(),e.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),e.fillStyle="#4299e1",e.fill(),e.closePath()}}class E{x;y;direction;owner;color;speed;size;constructor({x:e,y:r,direction:s,owner:o,color:l="#f6e05e",speed:f=7,size:v=5}){this.x=e,this.y=r,this.direction=s,this.owner=o,this.color=l,this.speed=f,this.size=v}update(e){this.x+=this.direction.x*this.speed*60*e,this.y+=this.direction.y*this.speed*60*e}draw(e){e.beginPath(),e.arc(this.x,this.y,this.size,0,Math.PI*2),e.fillStyle=this.color,e.fill(),e.closePath()}}class st{x;y;health;scoreValue;width=30;height=30;color;speed=4;hitboxRadius=10;fireTimer=0;constructor({x:e,y:r,health:s,scoreValue:o,color:l="#e53e3e"}){this.x=e,this.y=r,this.health=s,this.scoreValue=o,this.color=l}update(e){this.y+=this.speed*60*e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath()}}class wt extends st{fireRate=1;constructor({x:e,y:r,health:s,scoreValue:o,color:l}){super({x:e,y:r,health:s,scoreValue:o,color:l})}}class yt extends st{fireRate=1.5;constructor({x:e,y:r,health:s,scoreValue:o,color:l}){super({x:e,y:r,health:s,scoreValue:o,color:l})}}class Ut extends st{targetX;fireTimer=0;patterns=[{time:1,type:"spread",speed:4},{time:2,type:"circular",speed:2},{time:3,type:"spiral",speed:2},{time:4,type:"random",speed:6}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor({x:e,y:r,health:s,scoreValue:o}){super({x:e,y:r,health:s,scoreValue:o,color:"#f56565"}),this.targetX=e,this.maxHealth=s}update(e){this.x+=(this.targetX-this.x)*this.speed*60*e,this.fireTimer+=e,this.patternTimer+=e}draw(e){e.beginPath(),e.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),e.fillStyle=this.color,e.fill(),e.closePath();const r=this.width,s=10,o=this.x-r/2,l=this.y-this.height/2-s-5;e.fillStyle="#333",e.fillRect(o,l,r,s);const f=this.health/this.maxHealth*r;e.fillStyle="#27ae60",e.fillRect(o,l,f,s)}}function Wt(){}var qt=bt('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Dt=(n,e)=>{e.a=!0},Ot=(n,e)=>{e.a=!1},Kt=(n,e)=>{e.d=!0},Jt=(n,e)=>{e.d=!1},Qt=bt(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div> <div class="md:hidden absolute bottom-5 w-full flex justify-center gap-5"><button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">◀</button> <button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">▶</button></div></div>`);function re(n,e){Lt(e,!0);let r,s,o=b(0),l=b(3),f=b(!1),v=b(!1),x=Y({}),_=b(!1),B=b(0);const _t=4;let h=Y(new Ft),y=b(Y([])),I=b(Y([])),m=b(Y([])),a=b(null),A=b(0),k=b(0);const $=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],Tt="ontouchstart"in globalThis||navigator.maxTouchPoints>0,F=()=>{d(v,!0),d(f,!1),d(o,0),d(l,3),d(y,[],!0),d(I,[],!0),d(m,[],!0),d(a,null),d(A,0),d(k,0),d(_,!1),d(B,0),r&&(h.x=r.width/2,h.y=r.height-80),W=performance.now()};let U,W=0;xt(()=>{if(!t(v)||t(f))return;const u=S=>{const g=(S-W)/1e3;if(W=S,d(k,t(k)+g),!Tt){const i=x.shift?h.speed/2:h.speed;(x.arrowleft||x.a)&&(h.x-=i*60*g),(x.arrowright||x.d)&&(h.x+=i*60*g),(x.arrowup||x.w)&&(h.y-=i*60*g),(x.arrowdown||x.s)&&(h.y+=i*60*g),h.x=Math.max(h.hitboxRadius,Math.min(h.x,r.width-h.hitboxRadius)),h.y=Math.max(h.hitboxRadius,Math.min(h.y,r.height-h.hitboxRadius))}if(h.fireTimer+=g,h.fireTimer>=h.fireRate&&(t(I).push(new E({x:h.x,y:h.y,direction:{x:0,y:-1},owner:"player"})),h.fireTimer=0),t(_)&&(d(B,t(B)+g),t(B)>=_t&&(d(_,!1),d(B,0))),d(I,t(I).filter(i=>(i.update(g),i.y>-i.size)),!0),d(m,t(m).filter(i=>(i.update(g),i.y<r.height+i.size&&i.x>-i.size&&i.x<r.width+i.size)),!0),t(y).forEach(i=>{i.y+=i.speed*60*g,i.fireTimer+=g,i instanceof wt?i.fireTimer>=i.fireRate&&(t(m).push(new E({x:i.x,y:i.y+i.height,direction:{x:0,y:1},owner:"enemy",color:"#a0aec0"})),i.fireTimer=0):i instanceof yt&&i.fireTimer>=i.fireRate&&([-30,-15,0,15,30].forEach(T=>{const c=T*Math.PI/180,p=Math.sin(c),z=Math.cos(c);t(m).push(new E({x:i.x,y:i.y+i.height,direction:{x:p,y:z},owner:"enemy",color:"#a0aec0"}))}),i.fireTimer=0)}),d(y,t(y).filter(i=>i.y<r.height+i.height),!0),t(A)<$.length){const i=$[t(A)];t(k)>=i.time&&(i.type==="straight"?t(y).push(new wt({x:i.x,y:-50,health:10,scoreValue:10})):i.type==="spread"&&t(y).push(new yt({x:i.x,y:-50,health:15,scoreValue:20})),tt(A))}if(t(A)>=$.length&&t(y).length===0&&!t(a)&&d(a,new Ut({x:r.width/2,y:100,health:500,scoreValue:1e3}),!0),t(a)){t(a).update(g),Math.abs(t(a).x-t(a).targetX)<5&&(t(a).targetX=Math.random()*(r.width-t(a).width)+t(a).width/2);const i=t(a).patterns[t(a).currentPatternIndex];if(t(a).patternTimer>=i.time&&(t(a).currentPatternIndex=(t(a).currentPatternIndex+1)%t(a).patterns.length,t(a).patternTimer=0),t(a).fireTimer>=.5){const w=i.speed;switch(i.type){case"spread":for(let T=-2;T<=2;T++){const p=T*15*Math.PI/180,z=Math.sin(p),L=Math.cos(p);t(m).push(new E({x:t(a).x,y:t(a).y+t(a).height/2,direction:{x:z,y:L},owner:"enemy",color:"#ecc94b",speed:w,size:8}))}break;case"circular":{for(let c=0;c<12;c++){const p=c/12*Math.PI*2,z=Math.sin(p)*w,L=Math.cos(p)*w;t(m).push(new E({x:t(a).x,y:t(a).y+t(a).height/2,direction:{x:z,y:L},owner:"enemy",color:"#ecc94b",speed:w,size:6}))}break}case"spiral":{const c=t(a).fireTimer;for(let p=0;p<8;p++){const z=p/8*Math.PI*2+c,L=Math.sin(z)*w,At=Math.cos(z)*w;t(m).push(new E({x:t(a).x,y:t(a).y+t(a).height/2,direction:{x:L,y:At},owner:"enemy",color:"#ecc94b",speed:w,size:6}))}break}case"random":Math.random()>.5&&t(m).push(new E({x:t(a).x,y:t(a).y+t(a).height/2,direction:{x:Math.random()*2-1,y:1},owner:"enemy",color:"#ecc94b",speed:w,size:6}));break}t(a).fireTimer=0}}(()=>{const i=new Set,w=new Set;let T=t(o);t(I).forEach(c=>{t(y).forEach(p=>{Math.hypot(c.x-p.x,c.y-p.y)<p.hitboxRadius+c.size&&(i.add(c),w.add(p),p.health-=1,p.health<=0&&(T+=p.scoreValue))}),t(a)&&Math.hypot(c.x-t(a).x,c.y-t(a).y)<t(a).hitboxRadius+c.size&&(i.add(c),t(a).health-=1,t(a).health<=0&&(T+=t(a).scoreValue))}),t(_)||(t(m).forEach(c=>{Math.hypot(c.x-h.x,c.y-h.y)<h.hitboxRadius+c.size&&(i.add(c),tt(l,-1),t(l)<=0?d(f,!0):d(_,!0))}),t(y).forEach(c=>{Math.hypot(c.x-h.x,c.y-h.y)<h.hitboxRadius+c.hitboxRadius&&(tt(l,-1),t(l)<=0?d(f,!0):d(_,!0),w.add(c))})),d(I,t(I).filter(c=>!i.has(c)),!0),d(y,t(y).filter(c=>c.health>0&&!w.has(c)),!0),d(m,t(m).filter(c=>!i.has(c)),!0),d(o,T,!0)})(),s.clearRect(0,0,r.width,r.height),(!t(_)||t(_)&&Math.floor(t(B)*60/10)%2===0)&&h.draw(s);for(const i of t(I))i.draw(s);for(const i of t(y))i.draw(s);for(const i of t(m))i.draw(s);t(a)&&t(a).draw(s),U=requestAnimationFrame(u)};return U=requestAnimationFrame(u),()=>cancelAnimationFrame(U)});const at=u=>{x[u.key.toLowerCase()]=!0},ot=u=>{x[u.key.toLowerCase()]=!1};let C=0,H=0;function Mt(u){!t(v)||t(f)?F():(C=u.touches[0].clientX,H=u.touches[0].clientY,h.x=C,h.y=H)}function Pt(u){if(!t(v)||t(f))return;const S=u.touches[0].clientX,g=u.touches[0].clientY,N=S-C,i=g-H;h.x+=N,h.y+=i,C=S,H=g}xt(()=>(r&&(s=r.getContext("2d"),q(),h.x=r.width/2,h.y=r.height-80),window.addEventListener("keydown",at),window.addEventListener("keyup",ot),window.addEventListener("resize",q),()=>{window.removeEventListener("keydown",at),window.removeEventListener("keyup",ot),window.removeEventListener("resize",q)}));function q(){const u=document.querySelector(".relative.max-w-lg");u&&(r.width=u.offsetWidth,r.height=u.offsetHeight)}const Rt=Ht(()=>t(a)?t(a).health/t(a).maxHealth*100:0);var X=Qt();Yt(u=>{var S=qt();gt(u,S)}),X.__touchstart=Mt,X.__touchmove=Pt,X.__touchend=[Wt];var D=P(X),nt=P(D);jt(nt,u=>r=u,()=>r);var O=M(nt,2),K=P(O),St=P(K);R(K);var lt=M(K,2),zt=P(lt);R(lt),R(O);var V=M(O,2);let ht;var It=P(V);let ct;R(V);var j=M(V,2);let dt;var Et=M(P(j),4);Et.__click=F,R(j);var J=M(j,2);let ft;var Q=M(P(J),2),Bt=P(Q);R(Q);var Xt=M(Q,2);Xt.__click=F,R(J),R(D);var ut=M(D,2),Z=P(ut);Z.__touchstart=[Dt,x],Z.__touchend=[Ot,x];var pt=M(Z,2);pt.__touchstart=[Kt,x],pt.__touchend=[Jt,x],R(ut),R(X),kt((u,S,g,N)=>{et(St,`スコア: ${t(o)??""}`),et(zt,`残機: ${t(l)??""}`),ht=it(V,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,ht,u),ct=$t(It,"",ct,S),dt=it(j,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,dt,g),ft=it(J,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ft,N),et(Bt,`最終スコア: ${t(o)??""}`)},[()=>({hidden:!t(a)}),()=>({width:`${t(Rt)}%`}),()=>({hidden:t(v)}),()=>({hidden:!t(f)})]),gt(n,X),Ct()}Vt(["touchstart","touchmove","touchend","click"]);export{re as component};
