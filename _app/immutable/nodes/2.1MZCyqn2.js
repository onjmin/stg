import"../chunks/DsnmJJEf.js";import{o as W,_ as Me,as as z,aC as x,u as me,aa as e,at as d,aG as _,a5 as Ie,a2 as Le,af as F,a6 as Pe,a4 as pe,$ as He,ad as b,ae as B}from"../chunks/CYXQVpue.js";import{d as Se,s as $}from"../chunks/q5wOSprp.js";import{b as Ke}from"../chunks/DOpaPJET.js";const xe=[...` 	
\r\f \v\uFEFF`];function Ve(l,r,t){var a=l==null?"":""+l;if(t){for(var s in t)if(t[s])a=a?a+" "+s:s;else if(a.length)for(var c=s.length,A=0;(A=a.indexOf(s,A))>=0;){var p=A+c;(A===0||xe.includes(a[A-1]))&&(p===a.length||xe.includes(a[p]))?a=(A===0?"":a.substring(0,A))+a.substring(p+1):A=p}}return a===""?null:a}function ve(l,r=!1){var t=r?" !important;":";",a="";for(var s in l){var c=l[s];c!=null&&c!==""&&(a+=" "+s+": "+c+t)}return a}function Oe(l,r){if(r){var t="",a,s;return Array.isArray(r)?(a=r[0],s=r[1]):a=r,a&&(t+=ve(a)),s&&(t+=ve(s,!0)),t=t.trim(),t===""?null:t}return String(l)}function ee(l,r,t,a,s,c){var A=l.__className;if(W||A!==t||A===void 0){var p=Ve(t,a,c);(!W||p!==l.getAttribute("class"))&&(p==null?l.removeAttribute("class"):l.className=p),l.__className=t}else if(c&&s!==c)for(var g in c){var T=!!c[g];(s==null||T!==!!s[g])&&l.classList.toggle(g,T)}return c}function te(l,r={},t,a){for(var s in t){var c=t[s];r[s]!==c&&(t[s]==null?l.style.removeProperty(s):l.style.setProperty(s,c,a))}}function Ue(l,r,t,a){var s=l.__style;if(W||s!==r){var c=Oe(r,a);(!W||c!==l.getAttribute("style"))&&(c==null?l.removeAttribute("style"):l.style.cssText=c),l.__style=r}else a&&(Array.isArray(a)?(te(l,t?.[0],a[0]),te(l,t?.[1],a[1],"important")):te(l,t,a));return a}const ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAEdElEQVR4AdyYPWtUQRSGZwQt1VqwsRMMQRFTxC5qIYoIBjSilYGIlbU/wkoUtLHQiFaipFBS5hdY2FlapzbIep6z90zmzt6PmbubGJV5d+Z8v+/s3c3iIfeP//tvBIzkjYgh5oFdNZ72Dnjovlz75YCc46T0LOE9Xem8ml3xg4ByNgE4AkhqgyRZQznOdGnftrnmTyfGAvzqiyPu/K3vaU7NjhrpQAmyyzZoUauI+nY2gqMk6O3L7mIB2P7spXkVkSuEwVKoJEp3ag1S27ngk5KnIBWAL4AiEBw9ByPTt/e0qYWZD2rOyGgSoO9ClON+n3wdm7Uzt2KEa4EGg1zclm82vhTMjInzZEhOeHTkrKtJAIGaiIWFCyqCpgQNEIAMNmf2ElCb1jEDMNN6tZEn3iaA2IQInDRnZzAEOOeCfOri/NhnvXPJ06dLAPGaCBzABnE2xETMl7N//nLX3Ti17NjT/K6bt9w+AeQFEXYza09W7Q8e8WJA1nDtyhsHPv74oH1sRg55CnIEkDchAmeKrnfBCHPbEDbEPUrJU5srgFwVUd0MtuN5TkEAHzsw4kaYmyYegzxAbyDniW8b8TWuEgE0CI0hwI03gUSDESfffGlNHJOcMEPOvatUAA11ACQwmkAMUiCOp7bFyK/O2rs6Z21DBGQ1JglikAZm4+M8KwwWAKkUXaRi4mkddldtV2ywAJqORiMHlo/ddwAiBuLAiJufnVxALSBvKKYSEA+9eWZHxbxdvKN7HOMMUYuRi28WKBAQxvHTWQ3vx5+599vjH3vrF1eCn5vf/PbMAc7ej3Mtx2q8H/u10LnQu7J7tyEC3O3Fp9rYiHnv3crWegB+EpbmHjnAGV+c47133vvwF916kluCQQLiARBLceL6V/fg+eEaqCFv6fhVJW07/mlQKiC8xdwYH8im4T8/XXYbGxu1EIJqjsqgB70qky3MwOhDrgCajhgErClnCBjMz46IVw93XAz8gPzN7Q39KUIPfIAzkLPOk7135QigmTZ6t/XYGdQhLww0QKwPELd8dmmhy/qyq2P8EmaPzcnXHAFeymKED7H4gyAbfProPdeFphp8kZh4FmfCrcgRMFEMWYMEGWIQM2tZvrc+7FmVSdIQAWG49OIs2+6anzvnurCbGU70iBECOYdcATyLKXL6T+RUj8pMetE8R8CI7+8YFE6LpF8sqKh1joCJhgwXJ0NlC0u/ZoPVcuBZr+pDBrZBnGlfcbWvPgF6++3lIZJFPmTP8NAnQP/DN53Hd734+ODJNl785ulD0+2Pq4e/9gnI6Zz7LuX0Ks7JEVB7F5puP3cqz3lVn1vSm5cjgCYqomH4TG+/6l97NBnehVwB9KCxAXsw+YooPRTYQI3ClxIBcevB5HmMaARhg9h2Mexi5q8hAgaTN1qIAJVdTLqq022IAC08KC+lAvJufx/VlQjQP/H23LLvI8/WUSUCeFZrQESM1il7GCgR0ETjrwuaVkAqqlNQ/G5xTouH2LMWkHKoCZJgky3u4esPAAAA//8PuSOiAAAABklEQVQDAOQpdH9TChAxAAAAAElFTkSuQmCC",We="data:image/png;base64,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",De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABtUlEQVR4AexW262DMAxNOwhrwBejMAB8syBfsAaLtLZVV1ZCmwY7QpV8FZPgV87xQdW9hz//cwJXC+gKuALKCfgnpBygutwVUI9Q2cAVUA5QXe4KqEeobFBLgQfgOjJw2y5rAgS6bdsgbZ5negfoFIfdbFkRIGAMOka3LAu5RJzyyal8WBB4CGBf4fR9H9BEPhL5WpMLWhDI3ZHEkQRaEjjh0BKg6f96L39KnI9KwFmlgpYA3H9+WahQQCABWjR9rrZWQUOAMRXvMYniBqLgEgJ4vxWJKgT2fQ9HhsClWZAwJcCgm6YJR8ZxSUJ7NiXAoBHUMAxBGvpkHN8tTEPgtm1bgoFBx4FP/lePW5z/67uGQHLHuq5hHEeyaZqCNPZjTlKocGgJvFUoAca52ukjby0B7EHWdV2Qhv8mSJMxPFORwcOCAKnwmiZB4l+beKcgPDAXDY6nv32opWVBABshkDcR/rWJdwSNBgWUD7t6WRFgIAQMQR4ZJFEcdrNlTYCBMdB457jZXouAGcBcIyeQm1DtuCtQe8K5/q5AbkK143UUqI1a9HcCYhiXHF2BS8YuLv17BZ4AAAD//4+CmpMAAAAGSURBVAMA7sawYcuQSOEAAAAASUVORK5CYIIA",Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAADUElEQVR4AeyWPW4bMRCFKXepA1VOkSJtap1BgAQEgS8RqUiXKwRIlzOkTSlAZ9BZBFc5gMJvrFlwNxR/hpRiAzb4ln8zb97jUpbu3Av/u6aBkz+bEH7av13DgIheLBYuhJcu677v2loNIEoFMT6p6Pl87kLoug+WON9rY67j6r7FQFj4H+FTJWpmYkTDQi5dK+qtBsKCIl4F5qpqHEZ87IjHz6ubxcDp4cujFEIEQJQsVDzIIReQduYMDbGcRa2BQXyW2RBgMVFj4Kri1W+tiVIDNxFvMVFi4PTj4dHdH5X++j21qOkrZT8TOQMi3hP9l1ZiImVgJP7eW+BkfCeNu3o4HGTc8oADLuWgBrV0njORMqAc2f54rL9flpyYkGoDnFCMqMeahbvKQPhqewiOcdTWqDJAQQpYTorcFOCEOxUT20sZmH37/TaWM6zx4eNDOCxUDsiFI5V21jC7FJMycCnnWa2bDfDKezlp4TIZsNzVnFkrZ85A8DkYS6AgJ8cd5i7X/F8nlhxy4YBrzP40y91/onIGiEkCAcmAxGZLrtKWGJC38OHNH80Z+ksnNwQUDGIc1Co5fehLDBAngFgGwQMBX/2vVa4EVyPYig6JIZYccqdBsRrTmHBeamD2+dd7ySspsNvtXAxCkHgo97nWxf/9IUWpAcm5e/d0jbSQLPoHJ8mJcrIIX61WLgb2iCGWHJ86NOXUGsNGZlBlAC4toAVZ477+9N/aKpq1EMvl0gHdJ5YcjVEu5db1kr7GwOzT94/CGRZCiAqTzcQDE0DjydVw5TzXKLo+5NYYIN6E/X4/ysPEaKFhYjbAiXGCnGZJ/akJcsiFAy7mFtQaGK6RpRgmFLH82usDR60BchyFACcoCw0POOACFhqLgeIPmEFQNbfFALqqC5GUgYnTaiCj5XbbrwZud9bxSi1vYMZvG2j5YlIwT0Hj6Ik7c5juP/ktBsgXbDYbB5ggLAViiAWMW9FqQN7Cer0WHYhSbLdbF0LX6Qkmp/X04Wk1AIcAQTIoeNTE5uh6GJC3wGkiDLgLVdkDxAIfZr77PldaDwMQIWRkhJ8IISLCySG3Cb0MqAhEDUY45RA+SPZ93631NqDCVOi01/1u/bUMdBOYI3rxBv4CAAD//3MfRTEAAAAGSURBVAMA3M1DcMjGBaYAAAAASUVORK5CYIIA";class Xe{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;playerImage;spriteWidth=48;spriteHeight=48;animationFrame=0;animationTimer=0;animationSpeed=.1;constructor(){this.playerImage=new Image,this.playerImage.src=We}draw(r,t){this.animationTimer+=t,this.animationTimer>=this.animationSpeed&&(this.animationFrame=(this.animationFrame+1)%3,this.animationTimer=0),this.playerImage.complete&&r.drawImage(this.playerImage,0,this.animationFrame*this.spriteHeight,this.spriteWidth,this.spriteHeight,this.x-this.spriteWidth/2,this.y-this.spriteHeight/2,this.spriteWidth,this.spriteHeight)}}class Y{x;y;direction;owner;color;speed;size;damage;constructor({x:r,y:t,direction:a,owner:s,color:c="#6973fa",speed:A=7,size:p=5,damage:g=1}){this.x=r,this.y=t,this.direction=a,this.owner=s,this.color=c,this.speed=A,this.size=p,this.damage=g}update(r){this.x+=this.direction.x*this.speed*60*r,this.y+=this.direction.y*this.speed*60*r}draw(r){r.beginPath();const t=r.createRadialGradient(this.x,this.y,0,this.x,this.y,this.size);t.addColorStop(0,"white"),t.addColorStop(1,this.color),r.arc(this.x,this.y,this.size,0,Math.PI*2),r.fillStyle=t,r.fill(),r.closePath()}}class ie{x;y;health;scoreValue;width=48;height=48;bulletColor;speed=4;hitboxRadius=10;fireTimer=0;enemyImage;constructor({x:r,y:t,health:a,scoreValue:s,imageSrc:c,bulletColor:A="#e53e3e"}){this.x=r,this.y=t,this.health=a,this.scoreValue=s,this.bulletColor=A,this.enemyImage=new Image,this.enemyImage.src=c}update(r,t,a){this.y+=this.speed*60*r}draw(r){this.enemyImage.complete&&r.drawImage(this.enemyImage,this.x-this.width/2,this.y-this.height/2,this.width,this.height)}}class we extends ie{fireRate=1;constructor({x:r,y:t,health:a,scoreValue:s}){super({x:r,y:t,health:a,scoreValue:s,imageSrc:De})}}class ye extends ie{fireRate=1.5;constructor({x:r,y:t,health:a,scoreValue:s}){super({x:r,y:t,health:a,scoreValue:s,imageSrc:Ne})}}class Ge extends ie{targetX;targetY;moveOffset={x:0,y:0};fireTimer=0;patterns=[{time:1,type:"spread",speed:4,moveOffset:{x:.5,y:-.5}},{time:2,type:"circular",speed:2,moveOffset:{x:-.5,y:.5}},{time:3,type:"spiral",speed:2,moveOffset:{x:.8,y:.8}},{time:4,type:"random",speed:6,moveOffset:{x:-.8,y:-.8}}];currentPatternIndex=0;patternTimer=0;width=48;height=48;hitboxRadius=25;speed=.5;maxHealth;constructor({x:r,y:t,health:a,scoreValue:s}){super({x:r,y:t,health:a,scoreValue:s,bulletColor:"#9b68fa",imageSrc:ze}),this.targetX=r,this.targetY=t,this.maxHealth=a}update(r,t,a){const s=this.patterns[this.currentPatternIndex],c=(s.moveOffset.x+1)/2,A=(s.moveOffset.y+1)/2;this.targetX=c*(t-this.width),this.targetY=A*(a*.4-this.height),this.targetX+=this.width/2,this.targetY+=this.height/2,this.x+=(this.targetX-this.x)*this.speed*r,this.y+=(this.targetY-this.y)*this.speed*r,this.fireTimer+=r,this.patternTimer+=r}}function Ze(l,r){d(r,!1)}var qe=Ie('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Je=Ie(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面を指でなぞって移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div></div>`);function it(l,r){Me(r,!0);let t,a,s=x(0),c=x(3),A=x(!1),p=x(!1),g=z({}),T=x(!1),Q=x(!1),k=x(0);const Ce=4;let o=x(null),y=x(z([])),R=x(z([])),v=x(z([])),n=x(null),P=x(0),S=x(0);const D=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],N=()=>{d(p,!0),d(A,!1),d(s,0),d(c,3),d(y,[],!0),d(R,[],!0),d(v,[],!0),d(n,null),d(P,0),d(S,0),d(Q,!1),d(k,0),e(o)||d(o,new Xe,!0),t&&(e(o).x=t.width/2,e(o).y=t.height-80),V=performance.now()};let K,V=0;me(()=>{if(!e(p)||e(A))return;const u=C=>{if(!e(o))return;const m=(C-V)/1e3;if(V=C,e(T)){K=requestAnimationFrame(u);return}d(S,e(S)+m);const L=g.shift?e(o).speed/2:e(o).speed;if((g.arrowleft||g.a)&&(e(o).x-=L*60*m),(g.arrowright||g.d)&&(e(o).x+=L*60*m),(g.arrowup||g.w)&&(e(o).y-=L*60*m),(g.arrowdown||g.s)&&(e(o).y+=L*60*m),e(o).x=Math.max(e(o).hitboxRadius,Math.min(e(o).x,t.width-e(o).hitboxRadius)),e(o).y=Math.max(e(o).hitboxRadius,Math.min(e(o).y,t.height-e(o).hitboxRadius)),e(o).fireTimer+=m,e(o).fireTimer>=e(o).fireRate&&(e(R).push(new Y({x:e(o).x,y:e(o).y,direction:{x:0,y:-1},owner:"player",damage:5,color:"#fa6973"})),e(o).fireTimer=0),e(Q)&&(d(k,e(k)+m),e(k)>=Ce&&(d(Q,!1),d(k,0))),d(R,e(R).filter(i=>(i.update(m),i.y>-i.size)),!0),d(v,e(v).filter(i=>(i.update(m),i.y<t.height+i.size&&i.x>-i.size&&i.x<t.width+i.size)),!0),e(y).forEach(i=>{i.y+=i.speed*60*m,i.fireTimer+=m,i instanceof we?i.fireTimer>=i.fireRate&&(e(v).push(new Y({x:i.x,y:i.y+i.height,direction:{x:0,y:1},owner:"enemy",color:i.bulletColor})),i.fireTimer=0):i instanceof ye&&i.fireTimer>=i.fireRate&&([-30,-15,0,15,30].forEach(I=>{const h=I*Math.PI/180,f=Math.sin(h),E=Math.cos(h);e(v).push(new Y({x:i.x,y:i.y+i.height,direction:{x:f,y:E},owner:"enemy",color:i.bulletColor}))}),i.fireTimer=0)}),d(y,e(y).filter(i=>i.y<t.height+i.height),!0),e(P)<D.length){const i=D[e(P)];e(S)>=i.time&&(i.type==="straight"?e(y).push(new we({x:i.x,y:-50,health:10,scoreValue:10})):i.type==="spread"&&e(y).push(new ye({x:i.x,y:-50,health:15,scoreValue:20})),_(P))}if(e(P)>=D.length&&e(y).length===0&&!e(n)&&d(n,new Ge({x:t.width/2,y:100,health:500,scoreValue:1e3}),!0),e(n)){e(n).update(m,t.width,t.height);const i=e(n).patterns[e(n).currentPatternIndex];if(e(n).patternTimer>=i.time&&(e(n).currentPatternIndex=(e(n).currentPatternIndex+1)%e(n).patterns.length,e(n).patternTimer=0),e(n).fireTimer>=.5){const w=i.speed;switch(i.type){case"spread":for(let I=-2;I<=2;I++){const f=I*15*Math.PI/180,E=Math.sin(f),H=Math.cos(f);e(v).push(new Y({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:E,y:H},owner:"enemy",speed:w,size:8,color:e(n).bulletColor}))}break;case"circular":{for(let h=0;h<12;h++){const f=h/12*Math.PI*2,E=Math.sin(f)*w,H=Math.cos(f)*w;e(v).push(new Y({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:E,y:H},owner:"enemy",speed:w,size:6,color:e(n).bulletColor}))}break}case"spiral":{const h=e(n).fireTimer;for(let f=0;f<8;f++){const E=f/8*Math.PI*2+h,H=Math.sin(E)*w,ke=Math.cos(E)*w;e(v).push(new Y({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:H,y:ke},owner:"enemy",speed:w,size:6,color:e(n).bulletColor}))}break}case"random":Math.random()>.5&&e(v).push(new Y({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:Math.random()*2-1,y:1},owner:"enemy",speed:w,size:6,color:e(n).bulletColor}));break}e(n).fireTimer=0}}(()=>{if(!e(o))return;const i=new Set,w=new Set;let I=e(s);e(R).forEach(h=>{e(y).forEach(f=>{Math.hypot(h.x-f.x,h.y-f.y)<f.hitboxRadius+h.size&&(i.add(h),f.health-=h.damage,f.health<=0&&(w.add(f),I+=f.scoreValue))}),e(n)&&Math.hypot(h.x-e(n).x,h.y-e(n).y)<e(n).hitboxRadius+h.size&&(i.add(h),e(n).health-=h.damage,e(n).health<=0&&(I+=e(n).scoreValue),d(he,e(n).health/e(n).maxHealth*100))}),e(Q)||(e(v).forEach(h=>{if(!e(o))return;Math.hypot(h.x-e(o).x,h.y-e(o).y)<e(o).hitboxRadius+h.size&&(i.add(h),_(c,-1),e(c)<=0?d(A,!0):d(Q,!0))}),e(y).forEach(h=>{if(!e(o))return;Math.hypot(h.x-e(o).x,h.y-e(o).y)<e(o).hitboxRadius+h.hitboxRadius&&(_(c,-1),e(c)<=0?d(A,!0):d(Q,!0),w.add(h))})),d(R,e(R).filter(h=>!i.has(h)),!0),d(y,e(y).filter(h=>h.health>0&&!w.has(h)),!0),d(v,e(v).filter(h=>!i.has(h)),!0),d(s,I,!0)})(),a.clearRect(0,0,t.width,t.height),(!e(Q)||e(Q)&&Math.floor(e(k)*60/10)%2===0)&&e(o).draw(a,m);for(const i of e(R))i.draw(a);for(const i of e(y))i.draw(a);for(const i of e(v))i.draw(a);e(n)&&e(n).draw(a),K=requestAnimationFrame(u)};return K=requestAnimationFrame(u),()=>cancelAnimationFrame(K)});const ae=u=>{g[u.key.toLowerCase()]=!0},re=u=>{g[u.key.toLowerCase()]=!1};let X=0,se=x(!1);function Ee(u){if(!e(p)||e(A)){N();return}u.preventDefault(),d(se,!0),X=u.touches[0].clientX}function be(u){if(!e(p)||e(A)||!e(o))return;u.preventDefault();const C=u.touches[0].clientX,m=C-X;e(o).x+=m,X=C}const ne=()=>{d(T,!0)},oe=()=>{d(T,!1),V=performance.now()};me(()=>{if(e(o))return t&&(a=t.getContext("2d"),G(),e(o).x=t.width/2,e(o).y=t.height-80),window.addEventListener("keydown",ae),window.addEventListener("keyup",re),window.addEventListener("resize",G),window.addEventListener("blur",ne),window.addEventListener("focus",oe),()=>{window.removeEventListener("keydown",ae),window.removeEventListener("keyup",re),window.removeEventListener("resize",G),window.removeEventListener("blur",ne),window.removeEventListener("focus",oe)}});function G(){const u=document.querySelector(".relative.max-w-lg");u&&(t.width=u.offsetWidth,t.height=u.offsetHeight)}let he=x(100);var M=Je();Le(u=>{var C=qe();pe(u,C)}),M.__touchstart=Ee,M.__touchmove=be,M.__touchend=[Ze,se];var le=b(M),de=b(le);Ke(de,u=>t=u,()=>t);var Z=F(de,2),q=b(Z),Be=b(q);B(q);var ce=F(q,2),Qe=b(ce);B(ce),B(Z);var O=F(Z,2);let Ae;var Re=b(O);let ue;B(O);var U=F(O,2);let fe;var Fe=F(b(U),4);Fe.__click=N,B(U);var J=F(U,2);let ge;var j=F(b(J),2),Ye=b(j);B(j);var Te=F(j,2);Te.__click=N,B(J),B(le),B(M),Pe((u,C,m,L)=>{$(Be,`スコア: ${e(s)??""}`),$(Qe,`残機: ${e(c)??""}`),Ae=ee(O,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,Ae,u),ue=Ue(Re,"",ue,C),fe=ee(U,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,fe,m),ge=ee(J,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ge,L),$(Ye,`最終スコア: ${e(s)??""}`)},[()=>({hidden:!e(n)}),()=>({width:`${e(he)}%`}),()=>({hidden:e(p)}),()=>({hidden:!e(A)})]),pe(l,M),He()}Se(["touchstart","touchmove","touchend","click"]);export{it as component};
