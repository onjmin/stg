import"../chunks/DsnmJJEf.js";import{o as G,_ as zt,as as k,aC as T,u as dt,aa as t,aG as H,at as u,a5 as vt,a2 as Bt,af as R,ad as M,a6 as At,a4 as ft,$ as Xt,ae as P,aD as Lt}from"../chunks/CYXQVpue.js";import{d as kt,s as J}from"../chunks/q5wOSprp.js";import{b as It}from"../chunks/DOpaPJET.js";const ut=[...` 	
\r\f \v\uFEFF`];function Yt(h,i,e){var s=h==null?"":""+h;if(e){for(var n in e)if(e[n])s=s?s+" "+n:n;else if(s.length)for(var l=n.length,d=0;(d=s.indexOf(n,d))>=0;){var g=d+l;(d===0||ut.includes(s[d-1]))&&(g===s.length||ut.includes(s[g]))?s=(d===0?"":s.substring(0,d))+s.substring(g+1):d=g}}return s===""?null:s}function pt(h,i=!1){var e=i?" !important;":";",s="";for(var n in h){var l=h[n];l!=null&&l!==""&&(s+=" "+n+": "+l+e)}return s}function Ct(h,i){if(i){var e="",s,n;return Array.isArray(i)?(s=i[0],n=i[1]):s=i,s&&(e+=pt(s)),n&&(e+=pt(n,!0)),e=e.trim(),e===""?null:e}return String(h)}function Q(h,i,e,s,n,l){var d=h.__className;if(G||d!==e||d===void 0){var g=Yt(e,s,l);(!G||g!==h.getAttribute("class"))&&(g==null?h.removeAttribute("class"):h.className=g),h.__className=e}else if(l&&n!==l)for(var x in l){var r=!!l[x];(n==null||r!==!!n[x])&&h.classList.toggle(x,r)}return l}function Z(h,i={},e,s){for(var n in e){var l=e[n];i[n]!==l&&(e[n]==null?h.style.removeProperty(n):h.style.setProperty(n,l,s))}}function jt(h,i,e,s){var n=h.__style;if(G||n!==i){var l=Ct(i,s);(!G||l!==h.getAttribute("style"))&&(l==null?h.removeAttribute("style"):h.style.cssText=l),h.__style=i}else s&&(Array.isArray(s)?(Z(h,e?.[0],s[0]),Z(h,e?.[1],s[1],"important")):Z(h,e,s));return s}class Ht{x=0;y=0;speed=5;fireRate=10;fireTimer=0;hitboxRadius=5;draw(i){i.beginPath(),i.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),i.fillStyle="#4299e1",i.fill(),i.closePath()}}class B{x;y;direction;owner;color;speed;size;constructor(i,e,s,n,l="#f6e05e",d=7,g=5){this.x=i,this.y=e,this.direction=s,this.owner=n,this.color=l,this.speed=d,this.size=g}update(){typeof this.direction=="object"?(this.x+=this.direction.x*this.speed,this.y+=this.direction.y*this.speed):(this.x+=Math.cos(this.direction)*this.speed,this.y+=Math.sin(this.direction)*this.speed)}draw(i){i.beginPath(),i.arc(this.x,this.y,this.size,0,Math.PI*2),i.fillStyle=this.color,i.fill(),i.closePath()}}class tt{x;y;health;scoreValue;width=30;height=30;color;speed=1;hitboxRadius=10;fireTimer=0;constructor(i,e,s,n,l="#e53e3e"){this.x=i,this.y=e,this.health=s,this.scoreValue=n,this.color=l}draw(i){i.beginPath(),i.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),i.fillStyle=this.color,i.fill(),i.closePath()}}class xt extends tt{fireRate=60;constructor(i,e,s,n,l){super(i,e,s,n,l)}}class gt extends tt{fireRate=100;constructor(i,e,s,n,l){super(i,e,s,n,l)}}class Gt extends tt{targetX;fireTimer=0;patterns=[{time:60,type:"spread",speed:4},{time:120,type:"circular",speed:2},{time:180,type:"spiral",speed:2},{time:240,type:"random",speed:6}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor(i,e,s,n){super(i,e,s,n,"#f56565"),this.targetX=i,this.maxHealth=s}draw(i){i.beginPath(),i.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),i.fillStyle=this.color,i.fill(),i.closePath();const e=this.width,s=10,n=this.x-e/2,l=this.y-this.height/2-s-5;i.fillStyle="#333",i.fillRect(n,l,e,s);const d=this.health/this.maxHealth*e;i.fillStyle="#27ae60",i.fillRect(n,l,d,s)}}function $t(h,i,e,s,n){!t(i)||t(e)||s.fireTimer>=s.fireRate&&(t(n).push(new B(s.x,s.y,{x:0,y:-1},"player")),s.fireTimer=0)}var Ft=vt('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Ut=(h,i)=>{i.a=!0},Vt=(h,i)=>{i.a=!1},Wt=(h,i)=>{i.d=!0},qt=(h,i)=>{i.d=!1},Dt=vt(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div> <div class="md:hidden absolute bottom-5 w-full flex justify-center gap-5"><button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">◀</button> <button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">▶</button></div></div>`);function Zt(h,i){zt(i,!0);let e,s,n=T(0),l=T(3),d=T(!1),g=T(!1),x=k({}),r=k(new Ht),_=T(k([])),S=T(k([])),w=T(k([])),o=T(null),X=T(0),$=T(0);const F=[{time:50,type:"straight",x:50},{time:100,type:"straight",x:150},{time:150,type:"straight",x:250},{time:200,type:"straight",x:50},{time:250,type:"spread",x:150},{time:300,type:"spread",x:250},{time:400,type:"straight",x:100},{time:450,type:"spread",x:200},{time:500,type:"straight",x:150},{time:600,type:"straight",x:50},{time:650,type:"straight",x:150},{time:700,type:"spread",x:250}],mt="ontouchstart"in globalThis||navigator.maxTouchPoints>0,U=()=>{u(g,!0),u(d,!1),u(n,0),u(l,3),u(_,[],!0),u(S,[],!0),u(w,[],!0),u(o,null),u(X,0),u($,0),e&&(r.x=e.width/2,r.y=e.height-80)};dt(()=>{if(!t(g)||t(d))return;let f;const E=()=>{if(H($),mt||((x.ArrowLeft||x.a)&&(r.x-=r.speed),(x.ArrowRight||x.d)&&(r.x+=r.speed),(x.ArrowUp||x.w)&&(r.y-=r.speed),(x.ArrowDown||x.s)&&(r.y+=r.speed),r.x<r.hitboxRadius&&(r.x=r.hitboxRadius),r.x>e.width-r.hitboxRadius&&(r.x=e.width-r.hitboxRadius),r.y<r.hitboxRadius&&(r.y=r.hitboxRadius),r.y>e.height-r.hitboxRadius&&(r.y=e.height-r.hitboxRadius)),r.fireTimer++,r.fireTimer>=r.fireRate&&(t(S).push(new B(r.x,r.y,{x:0,y:-1},"player")),r.fireTimer=0),u(S,t(S).filter(a=>(a.update(),a.y>-a.size)),!0),u(w,t(w).filter(a=>(a.update(),a.y<e.height+a.size&&a.x>-a.size&&a.x<e.width+a.size)),!0),t(_).forEach(a=>{a.y+=a.speed,a.fireTimer++,a instanceof xt&&a.fireTimer>=a.fireRate&&(t(w).push(new B(a.x,a.y+a.height,{x:0,y:1},"enemy","#a0aec0")),a.fireTimer=0),a instanceof gt&&a.fireTimer>=a.fireRate&&([-30,-15,0,15,30].forEach(b=>{const m=b*Math.PI/180,c=Math.sin(m)*3,v=Math.cos(m)*3;t(w).push(new B(a.x,a.y+a.height,{x:c,y:v},"enemy","#a0aec0"))}),a.fireTimer=0)}),u(_,t(_).filter(a=>a.y<e.height+a.height),!0),t(X)<F.length){const a=F[t(X)];t($)>=a.time&&(a.type==="straight"?t(_).push(new xt(a.x,-50,10,10)):a.type==="spread"&&t(_).push(new gt(a.x,-50,15,20)),H(X))}if(t(X)>=F.length&&t(_).length===0&&!t(o)&&u(o,new Gt(e.width/2,100,500,1e3),!0),t(o)){t(o).x+=(t(o).targetX-t(o).x)*t(o).speed,Math.abs(t(o).x-t(o).targetX)<5&&(t(o).targetX=Math.random()*(e.width-t(o).width)+t(o).width/2),t(o).fireTimer++,t(o).patternTimer++;const a=t(o).patterns[t(o).currentPatternIndex];if(t(o).patternTimer>=a.time&&(t(o).currentPatternIndex=(t(o).currentPatternIndex+1)%t(o).patterns.length,t(o).patternTimer=0),t(o).fireTimer>=30){const p=a.speed;switch(a.type){case"spread":for(let b=-2;b<=2;b++){const c=b*15*Math.PI/180,v=Math.sin(c)*p,y=Math.cos(c)*p;t(w).push(new B(t(o).x,t(o).y+t(o).height/2,{x:v,y},"enemy","#ecc94b",p,8))}break;case"circular":{for(let m=0;m<12;m++){const c=m/12*Math.PI*2,v=Math.sin(c)*p,y=Math.cos(c)*p;t(w).push(new B(t(o).x,t(o).y+t(o).height/2,{x:v,y},"enemy","#ecc94b",p,6))}break}case"spiral":{const m=t(o).fireTimer*.1;for(let c=0;c<8;c++){const v=c/8*Math.PI*2+m,y=Math.sin(v)*p,z=Math.cos(v)*p;t(w).push(new B(t(o).x,t(o).y+t(o).height/2,{x:y,y:z},"enemy","#ecc94b",p,6))}break}case"random":Math.random()>.5&&t(w).push(new B(t(o).x,t(o).y+t(o).height/2,{x:Math.random()*2-1,y:1},"enemy","#ecc94b",p,6));break}t(o).fireTimer=0}}(()=>{const a=[...t(S)],p=[...t(_)],b=[...t(w)];let m=t(n);a.forEach((c,v)=>{let y=!1;p.forEach((z,Et)=>{Math.hypot(c.x-z.x,c.y-z.y)<z.hitboxRadius+c.size&&(y=!0,z.health-=1,z.health<=0&&(m+=z.scoreValue,p.splice(Et,1)))}),t(o)&&!y&&Math.hypot(c.x-t(o).x,c.y-t(o).y)<t(o).hitboxRadius+c.size&&(y=!0,t(o).health-=1,t(o).health<=0&&(m+=t(o).scoreValue,u(o,null))),y||a.splice(v,1)}),p.forEach((c,v)=>{Math.hypot(c.x-r.x,c.y-r.y)<r.hitboxRadius+c.hitboxRadius?(H(l,-1),t(l)<=0?u(d,!0):(r.x=e.width/2,r.y=e.height-80),p.splice(v,1)):c.y>e.height&&p.splice(v,1)}),b.forEach((c,v)=>{Math.hypot(c.x-r.x,c.y-r.y)<r.hitboxRadius+c.size&&(b.splice(v,1),H(l,-1),t(l)<=0?u(d,!0):(r.x=e.width/2,r.y=e.height-80))}),u(S,a,!0),u(_,p,!0),u(w,b,!0),u(n,m,!0)})(),s.clearRect(0,0,e.width,e.height),r.draw(s);for(const a of t(S))a.draw(s);for(const a of t(_))a.draw(s);for(const a of t(w))a.draw(s);t(o)&&t(o).draw(s),f=requestAnimationFrame(E)};return f=requestAnimationFrame(E),()=>cancelAnimationFrame(f)});const et=f=>{x[f.key.toLowerCase()]=!0,f.key===" "&&r.fireTimer>=r.fireRate&&(t(S).push(new B(r.x,r.y,{x:0,y:-1},"player")),r.fireTimer=0)},it=f=>{x[f.key.toLowerCase()]=!1};let I=0,Y=0;function wt(f){!t(g)||t(d)?U():(I=f.touches[0].clientX,Y=f.touches[0].clientY,r.x=I,r.y=Y)}function yt(f){if(!t(g)||t(d))return;const E=f.touches[0].clientX,L=f.touches[0].clientY,a=E-I,p=L-Y;r.x+=a,r.y+=p,I=E,Y=L}dt(()=>(e&&(s=e.getContext("2d"),V(),r.x=e.width/2,r.y=e.height-80),window.addEventListener("keydown",et),window.addEventListener("keyup",it),window.addEventListener("resize",V),()=>{window.removeEventListener("keydown",et),window.removeEventListener("keyup",it),window.removeEventListener("resize",V)}));function V(){const f=document.querySelector(".relative.max-w-lg");f&&(e.width=f.offsetWidth,e.height=f.offsetHeight)}const bt=Lt(()=>t(o)?t(o).health/t(o).maxHealth*100:0);var A=Dt();Bt(f=>{var E=Ft();ft(f,E)}),A.__touchstart=wt,A.__touchmove=yt,A.__touchend=[$t,g,d,r,S];var W=M(A),st=M(W);It(st,f=>e=f,()=>e);var q=R(st,2),D=M(q),_t=M(D);P(D);var rt=R(D,2),Tt=M(rt);P(rt),P(q);var C=R(q,2);let at;var Rt=M(C);let ot;P(C);var j=R(C,2);let nt;var Mt=R(M(j),4);Mt.__click=U,P(j);var N=R(j,2);let ht;var K=R(M(N),2),Pt=M(K);P(K);var St=R(K,2);St.__click=U,P(N),P(W);var lt=R(W,2),O=M(lt);O.__touchstart=[Ut,x],O.__touchend=[Vt,x];var ct=R(O,2);ct.__touchstart=[Wt,x],ct.__touchend=[qt,x],P(lt),P(A),At((f,E,L,a)=>{J(_t,`スコア: ${t(n)??""}`),J(Tt,`残機: ${t(l)??""}`),at=Q(C,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,at,f),ot=jt(Rt,"",ot,E),nt=Q(j,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,nt,L),ht=Q(N,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ht,a),J(Pt,`最終スコア: ${t(n)??""}`)},[()=>({hidden:!t(o)}),()=>({width:`${t(bt)}%`}),()=>({hidden:t(g)}),()=>({hidden:!t(d)})]),ft(h,A),Xt()}kt(["touchstart","touchmove","touchend","click"]);export{Zt as component};
