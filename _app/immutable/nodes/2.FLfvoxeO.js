import"../chunks/DsnmJJEf.js";import{o as W,_ as Ae,as as C,aC as m,u as xe,aa as e,at as l,aG as Z,a5 as Me,a2 as Xe,af as I,a6 as Ye,a4 as ve,$ as ke,ad as R,ae as T,aD as Ce}from"../chunks/CYXQVpue.js";import{d as Oe,s as ee}from"../chunks/q5wOSprp.js";import{b as He}from"../chunks/DOpaPJET.js";const me=[...` 	
\r\f \v\uFEFF`];function Ve(o,t,i){var s=o==null?"":""+o;if(i){for(var a in i)if(i[a])s=s?s+" "+a:a;else if(s.length)for(var h=a.length,f=0;(f=s.indexOf(a,f))>=0;){var g=f+h;(f===0||me.includes(s[f-1]))&&(g===s.length||me.includes(s[g]))?s=(f===0?"":s.substring(0,f))+s.substring(g+1):f=g}}return s===""?null:s}function we(o,t=!1){var i=t?" !important;":";",s="";for(var a in o){var h=o[a];h!=null&&h!==""&&(s+=" "+a+": "+h+i)}return s}function Fe(o,t){if(t){var i="",s,a;return Array.isArray(t)?(s=t[0],a=t[1]):s=t,s&&(i+=we(s)),a&&(i+=we(a,!0)),i=i.trim(),i===""?null:i}return String(o)}function te(o,t,i,s,a,h){var f=o.__className;if(W||f!==i||f===void 0){var g=Ve(i,s,h);(!W||g!==o.getAttribute("class"))&&(g==null?o.removeAttribute("class"):o.className=g),o.__className=i}else if(h&&a!==h)for(var x in h){var L=!!h[x];(a==null||L!==!!a[x])&&o.classList.toggle(x,L)}return h}function ie(o,t={},i,s){for(var a in i){var h=i[a];t[a]!==h&&(i[a]==null?o.style.removeProperty(a):o.style.setProperty(a,h,s))}}function Ne(o,t,i,s){var a=o.__style;if(W||a!==t){var h=Fe(t,s);(!W||h!==o.getAttribute("style"))&&(h==null?o.removeAttribute("style"):o.style.cssText=h),o.__style=t}else s&&(Array.isArray(s)?(ie(o,i?.[0],s[0]),ie(o,i?.[1],s[1],"important")):ie(o,i,s));return s}class De{x=0;y=0;speed=5;fireRate=.2;fireTimer=0;hitboxRadius=5;draw(t){t.beginPath(),t.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),t.fillStyle="#4299e1",t.fill(),t.closePath()}}class _{x;y;direction;owner;color;speed;size;constructor({x:t,y:i,direction:s,owner:a,color:h="#f6e05e",speed:f=7,size:g=5}){this.x=t,this.y=i,this.direction=s,this.owner=a,this.color=h,this.speed=f,this.size=g}update(t){this.x+=this.direction.x*this.speed*60*t,this.y+=this.direction.y*this.speed*60*t}draw(t){t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.closePath()}}class se{x;y;health;scoreValue;width=30;height=30;color;speed=4;hitboxRadius=10;fireTimer=0;constructor({x:t,y:i,health:s,scoreValue:a,color:h="#e53e3e"}){this.x=t,this.y=i,this.health=s,this.scoreValue=a,this.color=h}update(t){this.y+=this.speed*60*t}draw(t){t.beginPath(),t.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),t.fillStyle=this.color,t.fill(),t.closePath()}}class ye extends se{fireRate=1;constructor({x:t,y:i,health:s,scoreValue:a,color:h}){super({x:t,y:i,health:s,scoreValue:a,color:h})}}class be extends se{fireRate=1.5;constructor({x:t,y:i,health:s,scoreValue:a,color:h}){super({x:t,y:i,health:s,scoreValue:a,color:h})}}class Ge extends se{targetX;targetY;moveOffset={x:0,y:0};fireTimer=0;patterns=[{time:1,type:"spread",speed:4,moveOffset:{x:.5,y:-.5}},{time:2,type:"circular",speed:2,moveOffset:{x:-.5,y:.5}},{time:3,type:"spiral",speed:2,moveOffset:{x:.8,y:.8}},{time:4,type:"random",speed:6,moveOffset:{x:-.8,y:-.8}}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor({x:t,y:i,health:s,scoreValue:a}){super({x:t,y:i,health:s,scoreValue:a,color:"#f56565"}),this.targetX=t,this.targetY=i,this.maxHealth=s}update(t,i,s){const a=this.patterns[this.currentPatternIndex],h=(a.moveOffset.x+1)/2,f=(a.moveOffset.y+1)/2;this.targetX=h*(i-this.width),this.targetY=f*(s*.4-this.height),this.targetX+=this.width/2,this.targetY+=this.height/2,this.x+=(this.targetX-this.x)*this.speed*t,this.y+=(this.targetY-this.y)*this.speed*t,this.fireTimer+=t,this.patternTimer+=t}draw(t){t.beginPath(),t.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),t.fillStyle=this.color,t.fill(),t.closePath();const i=this.width,s=10,a=this.x-i/2,h=this.y-this.height/2-s-5;t.fillStyle="#333",t.fillRect(a,h,i,s);const f=this.health/this.maxHealth*i;t.fillStyle="#27ae60",t.fillRect(a,h,f,s)}}function We(o,t,i,s,a){if(!e(t)||e(i)){s();return}o.preventDefault(),a(o.touches[0].clientX)}function $e(o,t,i,s){!e(t)||e(i)||(o.preventDefault(),s(o.touches[0].clientX))}function je(o,t,i){l(t,!1),l(i,!1)}var qe=Me('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Ue=Me(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div></div>`);function tt(o,t){Ae(t,!0);let i,s,a=m(0),h=m(3),f=m(!1),g=m(!1),x=C({}),L=m(!1),S=m(!1),B=m(0);const Pe=4;let c=C(new De),b=m(C([])),z=m(C([])),w=m(C([])),n=m(null),Y=m(0),O=m(0);const $=[{time:1,type:"straight",x:50},{time:2,type:"straight",x:150},{time:3,type:"straight",x:250},{time:4,type:"straight",x:50},{time:5,type:"spread",x:150},{time:6,type:"spread",x:250},{time:7,type:"straight",x:100},{time:8,type:"spread",x:200},{time:9,type:"straight",x:150},{time:10,type:"straight",x:50},{time:11,type:"straight",x:150},{time:12,type:"spread",x:250},{time:13,type:"straight",x:50},{time:14,type:"spread",x:150},{time:15,type:"straight",x:250}],Re="ontouchstart"in globalThis||navigator.maxTouchPoints>0,j=()=>{l(g,!0),l(f,!1),l(a,0),l(h,3),l(b,[],!0),l(z,[],!0),l(w,[],!0),l(n,null),l(Y,0),l(O,0),l(S,!1),l(B,0),i&&(c.x=i.width/2,c.y=i.height-80),V=performance.now()};let H,V=0;xe(()=>{if(!e(g)||e(f))return;const p=E=>{const v=(E-V)/1e3;if(V=E,e(L)){H=requestAnimationFrame(p);return}l(O,e(O)+v);const X=x.shift?c.speed/2:c.speed;if((x.arrowleft||x.a)&&(c.x-=X*60*v),(x.arrowright||x.d)&&(c.x+=X*60*v),(x.arrowup||x.w)&&(c.y-=X*60*v),(x.arrowdown||x.s)&&(c.y+=X*60*v),Re){const r=c.speed*60*v;e(F)&&(c.x-=r),e(N)&&(c.x+=r)}if(c.x=Math.max(c.hitboxRadius,Math.min(c.x,i.width-c.hitboxRadius)),c.y=Math.max(c.hitboxRadius,Math.min(c.y,i.height-c.hitboxRadius)),c.fireTimer+=v,c.fireTimer>=c.fireRate&&(e(z).push(new _({x:c.x,y:c.y,direction:{x:0,y:-1},owner:"player"})),c.fireTimer=0),e(S)&&(l(B,e(B)+v),e(B)>=Pe&&(l(S,!1),l(B,0))),l(z,e(z).filter(r=>(r.update(v),r.y>-r.size)),!0),l(w,e(w).filter(r=>(r.update(v),r.y<i.height+r.size&&r.x>-r.size&&r.x<i.width+r.size)),!0),e(b).forEach(r=>{r.y+=r.speed*60*v,r.fireTimer+=v,r instanceof ye?r.fireTimer>=r.fireRate&&(e(w).push(new _({x:r.x,y:r.y+r.height,direction:{x:0,y:1},owner:"enemy",color:"#a0aec0"})),r.fireTimer=0):r instanceof be&&r.fireTimer>=r.fireRate&&([-30,-15,0,15,30].forEach(M=>{const d=M*Math.PI/180,u=Math.sin(d),P=Math.cos(d);e(w).push(new _({x:r.x,y:r.y+r.height,direction:{x:u,y:P},owner:"enemy",color:"#a0aec0"}))}),r.fireTimer=0)}),l(b,e(b).filter(r=>r.y<i.height+r.height),!0),e(Y)<$.length){const r=$[e(Y)];e(O)>=r.time&&(r.type==="straight"?e(b).push(new ye({x:r.x,y:-50,health:10,scoreValue:10})):r.type==="spread"&&e(b).push(new be({x:r.x,y:-50,health:15,scoreValue:20})),Z(Y))}if(e(Y)>=$.length&&e(b).length===0&&!e(n)&&l(n,new Ge({x:i.width/2,y:100,health:500,scoreValue:1e3}),!0),e(n)){e(n).update(v,i.width,i.height);const r=e(n).patterns[e(n).currentPatternIndex];if(e(n).patternTimer>=r.time&&(e(n).currentPatternIndex=(e(n).currentPatternIndex+1)%e(n).patterns.length,e(n).patternTimer=0),e(n).fireTimer>=.5){const y=r.speed;switch(r.type){case"spread":for(let M=-2;M<=2;M++){const u=M*15*Math.PI/180,P=Math.sin(u),k=Math.cos(u);e(w).push(new _({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:P,y:k},owner:"enemy",color:"#ecc94b",speed:y,size:8}))}break;case"circular":{for(let d=0;d<12;d++){const u=d/12*Math.PI*2,P=Math.sin(u)*y,k=Math.cos(u)*y;e(w).push(new _({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:P,y:k},owner:"enemy",color:"#ecc94b",speed:y,size:6}))}break}case"spiral":{const d=e(n).fireTimer;for(let u=0;u<8;u++){const P=u/8*Math.PI*2+d,k=Math.sin(P)*y,Be=Math.cos(P)*y;e(w).push(new _({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:k,y:Be},owner:"enemy",color:"#ecc94b",speed:y,size:6}))}break}case"random":Math.random()>.5&&e(w).push(new _({x:e(n).x,y:e(n).y+e(n).height/2,direction:{x:Math.random()*2-1,y:1},owner:"enemy",color:"#ecc94b",speed:y,size:6}));break}e(n).fireTimer=0}}(()=>{const r=new Set,y=new Set;let M=e(a);e(z).forEach(d=>{e(b).forEach(u=>{Math.hypot(d.x-u.x,d.y-u.y)<u.hitboxRadius+d.size&&(r.add(d),y.add(u),u.health-=1,u.health<=0&&(M+=u.scoreValue))}),e(n)&&Math.hypot(d.x-e(n).x,d.y-e(n).y)<e(n).hitboxRadius+d.size&&(r.add(d),e(n).health-=1,e(n).health<=0&&(M+=e(n).scoreValue))}),e(S)||(e(w).forEach(d=>{Math.hypot(d.x-c.x,d.y-c.y)<c.hitboxRadius+d.size&&(r.add(d),Z(h,-1),e(h)<=0?l(f,!0):l(S,!0))}),e(b).forEach(d=>{Math.hypot(d.x-c.x,d.y-c.y)<c.hitboxRadius+d.hitboxRadius&&(Z(h,-1),e(h)<=0?l(f,!0):l(S,!0),y.add(d))})),l(z,e(z).filter(d=>!r.has(d)),!0),l(b,e(b).filter(d=>d.health>0&&!y.has(d)),!0),l(w,e(w).filter(d=>!r.has(d)),!0),l(a,M,!0)})(),s.clearRect(0,0,i.width,i.height),(!e(S)||e(S)&&Math.floor(e(B)*60/10)%2===0)&&c.draw(s);for(const r of e(z))r.draw(s);for(const r of e(b))r.draw(s);for(const r of e(w))r.draw(s);e(n)&&e(n).draw(s),H=requestAnimationFrame(p)};return H=requestAnimationFrame(p),()=>cancelAnimationFrame(H)});const re=p=>{x[p.key.toLowerCase()]=!0},ae=p=>{x[p.key.toLowerCase()]=!1};let F=m(!1),N=m(!1);function oe(p){const E=i.width/2;p<E?(l(F,!0),l(N,!1)):(l(N,!0),l(F,!1))}const ne=()=>{l(L,!0)},he=()=>{l(L,!1),V=performance.now()};xe(()=>(i&&(s=i.getContext("2d"),q(),c.x=i.width/2,c.y=i.height-80),window.addEventListener("keydown",re),window.addEventListener("keyup",ae),window.addEventListener("resize",q),window.addEventListener("blur",ne),window.addEventListener("focus",he),()=>{window.removeEventListener("keydown",re),window.removeEventListener("keyup",ae),window.removeEventListener("resize",q),window.removeEventListener("blur",ne),window.removeEventListener("focus",he)}));function q(){const p=document.querySelector(".relative.max-w-lg");p&&(i.width=p.offsetWidth,i.height=p.offsetHeight)}const Te=Ce(()=>e(n)?e(n).health/e(n).maxHealth*100:0);var A=Ue();Xe(p=>{var E=qe();ve(p,E)}),A.__touchstart=[We,g,f,j,oe],A.__touchmove=[$e,g,f,oe],A.__touchend=[je,F,N];var le=R(A),de=R(le);He(de,p=>i=p,()=>i);var U=I(de,2),K=R(U),Se=R(K);T(K);var ce=I(K,2),ze=R(ce);T(ce),T(U);var D=I(U,2);let fe;var Ee=R(D);let ue;T(D);var G=I(D,2);let pe;var Ie=I(R(G),4);Ie.__click=j,T(G);var J=I(G,2);let ge;var Q=I(R(J),2),_e=R(Q);T(Q);var Le=I(Q,2);Le.__click=j,T(J),T(le),T(A),Ye((p,E,v,X)=>{ee(Se,`スコア: ${e(a)??""}`),ee(ze,`残機: ${e(h)??""}`),fe=te(D,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,fe,p),ue=Ne(Ee,"",ue,E),pe=te(G,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,pe,v),ge=te(J,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ge,X),ee(_e,`最終スコア: ${e(a)??""}`)},[()=>({hidden:!e(n)}),()=>({width:`${e(Te)}%`}),()=>({hidden:e(g)}),()=>({hidden:!e(f)})]),ve(o,A),ke()}Oe(["touchstart","touchmove","touchend","click"]);export{tt as component};
