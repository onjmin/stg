import"../chunks/DsnmJJEf.js";import{o as U,_ as At,as as k,aC as b,u as ut,aa as t,aG as C,at as d,a5 as wt,a2 as Xt,af as M,ad as P,a6 as Lt,a4 as pt,$ as Yt,ae as S,aD as kt}from"../chunks/CYXQVpue.js";import{d as Ct,s as Z}from"../chunks/q5wOSprp.js";import{b as jt}from"../chunks/DOpaPJET.js";const gt=[...` 	
\r\f \v\uFEFF`];function Ht(l,i,e){var s=l==null?"":""+l;if(e){for(var n in e)if(e[n])s=s?s+" "+n:n;else if(s.length)for(var h=n.length,f=0;(f=s.indexOf(n,f))>=0;){var v=f+h;(f===0||gt.includes(s[f-1]))&&(v===s.length||gt.includes(s[v]))?s=(f===0?"":s.substring(0,f))+s.substring(v+1):f=v}}return s===""?null:s}function xt(l,i=!1){var e=i?" !important;":";",s="";for(var n in l){var h=l[n];h!=null&&h!==""&&(s+=" "+n+": "+h+e)}return s}function Nt(l,i){if(i){var e="",s,n;return Array.isArray(i)?(s=i[0],n=i[1]):s=i,s&&(e+=xt(s)),n&&(e+=xt(n,!0)),e=e.trim(),e===""?null:e}return String(l)}function tt(l,i,e,s,n,h){var f=l.__className;if(U||f!==e||f===void 0){var v=Ht(e,s,h);(!U||v!==l.getAttribute("class"))&&(v==null?l.removeAttribute("class"):l.className=v),l.__className=e}else if(h&&n!==h)for(var g in h){var _=!!h[g];(n==null||_!==!!n[g])&&l.classList.toggle(g,_)}return h}function et(l,i={},e,s){for(var n in e){var h=e[n];i[n]!==h&&(e[n]==null?l.style.removeProperty(n):l.style.setProperty(n,h,s))}}function Gt(l,i,e,s){var n=l.__style;if(U||n!==i){var h=Nt(i,s);(!U||h!==l.getAttribute("style"))&&(h==null?l.removeAttribute("style"):l.style.cssText=h),l.__style=i}else s&&(Array.isArray(s)?(et(l,e?.[0],s[0]),et(l,e?.[1],s[1],"important")):et(l,e,s));return s}class Ut{x=0;y=0;speed=5;fireRate=10;fireTimer=0;hitboxRadius=5;draw(i){i.beginPath(),i.arc(this.x,this.y,this.hitboxRadius*2.5,0,Math.PI*2),i.fillStyle="#4299e1",i.fill(),i.closePath()}}class z{x;y;direction;owner;color;speed;size;constructor(i,e,s,n,h="#f6e05e",f=7,v=5){this.x=i,this.y=e,this.direction=s,this.owner=n,this.color=h,this.speed=f,this.size=v}update(){typeof this.direction=="object"?(this.x+=this.direction.x*this.speed,this.y+=this.direction.y*this.speed):(this.x+=Math.cos(this.direction)*this.speed,this.y+=Math.sin(this.direction)*this.speed)}draw(i){i.beginPath(),i.arc(this.x,this.y,this.size,0,Math.PI*2),i.fillStyle=this.color,i.fill(),i.closePath()}}class it{x;y;health;scoreValue;width=30;height=30;color;speed=1;hitboxRadius=10;fireTimer=0;constructor(i,e,s,n,h="#e53e3e"){this.x=i,this.y=e,this.health=s,this.scoreValue=n,this.color=h}draw(i){i.beginPath(),i.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),i.fillStyle=this.color,i.fill(),i.closePath()}}class vt extends it{fireRate=60;constructor(i,e,s,n,h){super(i,e,s,n,h)}}class mt extends it{fireRate=100;constructor(i,e,s,n,h){super(i,e,s,n,h)}}class Vt extends it{targetX;fireTimer=0;patterns=[{time:60,type:"spread",speed:4},{time:120,type:"circular",speed:2},{time:180,type:"spiral",speed:2},{time:240,type:"random",speed:6}];currentPatternIndex=0;patternTimer=0;width=100;height=100;hitboxRadius=25;speed=.5;maxHealth;constructor(i,e,s,n){super(i,e,s,n,"#f56565"),this.targetX=i,this.maxHealth=s}draw(i){i.beginPath(),i.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),i.fillStyle=this.color,i.fill(),i.closePath();const e=this.width,s=10,n=this.x-e/2,h=this.y-this.height/2-s-5;i.fillStyle="#333",i.fillRect(n,h,e,s);const f=this.health/this.maxHealth*e;i.fillStyle="#27ae60",i.fillRect(n,h,f,s)}}function $t(){}var Dt=wt('<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&amp;display=swap" rel="stylesheet"/>'),Ft=(l,i)=>{i.a=!0},Wt=(l,i)=>{i.a=!1},qt=(l,i)=>{i.d=!0},Ot=(l,i)=>{i.d=!1},Kt=wt(`<div class="bg-gray-900 text-white font-['M_PLUS_Rounded_1c'] flex flex-col justify-center items-center h-screen overflow-hidden"><div class="relative max-w-lg w-full h-full my-4 shadow-lg rounded-lg overflow-hidden"><canvas class="bg-black border-2 border-gray-600 w-full h-full touch-none"></canvas> <div class="absolute top-0 left-0 w-full flex justify-between p-4 box-border pointer-events-none z-10"><div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div> <div class="text-xl font-bold p-2 bg-gray-700 rounded-lg shadow-lg"> </div></div> <div><div class="h-full bg-red-500 transition-all duration-300"></div></div> <div><h1 class="text-4xl sm:text-6xl font-extrabold text-blue-400 mb-6">スマホで遊べるSTG</h1> <p class="text-lg sm:text-2xl font-semibold mb-8 text-gray-300">画面をタッチして左右に移動。<br/> PCでは十字キーで操作。<br/> 弾は自動で発射されます。</p> <button class="px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">ゲームスタート</button></div> <div><h2 class="text-6xl font-extrabold text-red-500 mb-4 animate-pulse">ゲームオーバー</h2> <p class="text-3xl font-semibold text-gray-300 mb-8"> </p> <button class="px-8 py-4 bg-green-500 hover:bg-green-600 rounded-full text-xl sm:text-3xl font-bold transition-transform transform hover:scale-105 shadow-lg">リスタート</button></div></div> <div class="md:hidden absolute bottom-5 w-full flex justify-center gap-5"><button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">◀</button> <button class="bg-gray-600 text-white rounded-full w-20 h-20 text-3xl flex justify-center items-center cursor-pointer select-none shadow-lg active:scale-95 transition-transform">▶</button></div></div>`);function ie(l,i){At(i,!0);let e,s,n=b(0),h=b(3),f=b(!1),v=b(!1),g=k({}),_=b(!1),X=b(0);const yt=240;let o=k(new Ut),R=b(k([])),B=b(k([])),w=b(k([])),a=b(null),L=b(0),V=b(0);const $=[{time:50,type:"straight",x:50},{time:100,type:"straight",x:150},{time:150,type:"straight",x:250},{time:200,type:"straight",x:50},{time:250,type:"spread",x:150},{time:300,type:"spread",x:250},{time:400,type:"straight",x:100},{time:450,type:"spread",x:200},{time:500,type:"straight",x:150},{time:600,type:"straight",x:50},{time:650,type:"straight",x:150},{time:700,type:"spread",x:250}],bt="ontouchstart"in globalThis||navigator.maxTouchPoints>0,D=()=>{d(v,!0),d(f,!1),d(n,0),d(h,3),d(R,[],!0),d(B,[],!0),d(w,[],!0),d(a,null),d(L,0),d(V,0),d(_,!1),d(X,0),e&&(o.x=e.width/2,o.y=e.height-80)};ut(()=>{if(!t(v)||t(f))return;let u;const E=()=>{if(C(V),bt||((g.ArrowLeft||g.a)&&(o.x-=o.speed),(g.ArrowRight||g.d)&&(o.x+=o.speed),(g.ArrowUp||g.w)&&(o.y-=o.speed),(g.ArrowDown||g.s)&&(o.y+=o.speed),o.x<o.hitboxRadius&&(o.x=o.hitboxRadius),o.x>e.width-o.hitboxRadius&&(o.x=e.width-o.hitboxRadius),o.y<o.hitboxRadius&&(o.y=o.hitboxRadius),o.y>e.height-o.hitboxRadius&&(o.y=e.height-o.hitboxRadius)),o.fireTimer++,o.fireTimer>=o.fireRate&&(t(B).push(new z(o.x,o.y,{x:0,y:-1},"player")),o.fireTimer=0),t(_)&&(C(X),t(X)>=yt&&(d(_,!1),d(X,0))),d(B,t(B).filter(r=>(r.update(),r.y>-r.size)),!0),d(w,t(w).filter(r=>(r.update(),r.y<e.height+r.size&&r.x>-r.size&&r.x<e.width+r.size)),!0),t(R).forEach(r=>{r.y+=r.speed,r.fireTimer++,r instanceof vt&&r.fireTimer>=r.fireRate&&(t(w).push(new z(r.x,r.y+r.height,{x:0,y:1},"enemy","#a0aec0")),r.fireTimer=0),r instanceof mt&&r.fireTimer>=r.fireRate&&([-30,-15,0,15,30].forEach(T=>{const m=T*Math.PI/180,c=Math.sin(m)*3,x=Math.cos(m)*3;t(w).push(new z(r.x,r.y+r.height,{x:c,y:x},"enemy","#a0aec0"))}),r.fireTimer=0)}),d(R,t(R).filter(r=>r.y<e.height+r.height),!0),t(L)<$.length){const r=$[t(L)];t(V)>=r.time&&(r.type==="straight"?t(R).push(new vt(r.x,-50,10,10)):r.type==="spread"&&t(R).push(new mt(r.x,-50,15,20)),C(L))}if(t(L)>=$.length&&t(R).length===0&&!t(a)&&d(a,new Vt(e.width/2,100,500,1e3),!0),t(a)){t(a).x+=(t(a).targetX-t(a).x)*t(a).speed,Math.abs(t(a).x-t(a).targetX)<5&&(t(a).targetX=Math.random()*(e.width-t(a).width)+t(a).width/2),t(a).fireTimer++,t(a).patternTimer++;const r=t(a).patterns[t(a).currentPatternIndex];if(t(a).patternTimer>=r.time&&(t(a).currentPatternIndex=(t(a).currentPatternIndex+1)%t(a).patterns.length,t(a).patternTimer=0),t(a).fireTimer>=30){const p=r.speed;switch(r.type){case"spread":for(let T=-2;T<=2;T++){const c=T*15*Math.PI/180,x=Math.sin(c)*p,y=Math.cos(c)*p;t(w).push(new z(t(a).x,t(a).y+t(a).height/2,{x,y},"enemy","#ecc94b",p,8))}break;case"circular":{for(let m=0;m<12;m++){const c=m/12*Math.PI*2,x=Math.sin(c)*p,y=Math.cos(c)*p;t(w).push(new z(t(a).x,t(a).y+t(a).height/2,{x,y},"enemy","#ecc94b",p,6))}break}case"spiral":{const m=t(a).fireTimer*.1;for(let c=0;c<8;c++){const x=c/8*Math.PI*2+m,y=Math.sin(x)*p,I=Math.cos(x)*p;t(w).push(new z(t(a).x,t(a).y+t(a).height/2,{x:y,y:I},"enemy","#ecc94b",p,6))}break}case"random":Math.random()>.5&&t(w).push(new z(t(a).x,t(a).y+t(a).height/2,{x:Math.random()*2-1,y:1},"enemy","#ecc94b",p,6));break}t(a).fireTimer=0}}(()=>{const r=[...t(B)],p=[...t(R)],T=[...t(w)];let m=t(n);r.forEach((c,x)=>{let y=!1;p.forEach((I,zt)=>{Math.hypot(c.x-I.x,c.y-I.y)<I.hitboxRadius+c.size&&(y=!0,I.health-=1,I.health<=0&&(m+=I.scoreValue,p.splice(zt,1)))}),t(a)&&!y&&Math.hypot(c.x-t(a).x,c.y-t(a).y)<t(a).hitboxRadius+c.size&&(y=!0,t(a).health-=1,t(a).health<=0&&(m+=t(a).scoreValue,d(a,null))),y||r.splice(x,1)}),t(_)?p.forEach((c,x)=>{c.y>e.height&&p.splice(x,1)}):(p.forEach((c,x)=>{Math.hypot(c.x-o.x,c.y-o.y)<o.hitboxRadius+c.hitboxRadius?(C(h,-1),t(h)<=0?d(f,!0):(o.x=e.width/2,o.y=e.height-80,d(_,!0)),p.splice(x,1)):c.y>e.height&&p.splice(x,1)}),T.forEach((c,x)=>{Math.hypot(c.x-o.x,c.y-o.y)<o.hitboxRadius+c.size&&(T.splice(x,1),C(h,-1),t(h)<=0?d(f,!0):(o.x=e.width/2,o.y=e.height-80,d(_,!0)))})),d(B,r,!0),d(R,p,!0),d(w,T,!0),d(n,m,!0)})(),s.clearRect(0,0,e.width,e.height),(!t(_)||t(_)&&Math.floor(t(X)/10)%2===0)&&o.draw(s);for(const r of t(B))r.draw(s);for(const r of t(R))r.draw(s);for(const r of t(w))r.draw(s);t(a)&&t(a).draw(s),u=requestAnimationFrame(E)};return u=requestAnimationFrame(E),()=>cancelAnimationFrame(u)});const st=u=>{g[u.key.toLowerCase()]=!0},rt=u=>{g[u.key.toLowerCase()]=!1};let j=0,H=0;function _t(u){!t(v)||t(f)?D():(j=u.touches[0].clientX,H=u.touches[0].clientY,o.x=j,o.y=H)}function Tt(u){if(!t(v)||t(f))return;const E=u.touches[0].clientX,Y=u.touches[0].clientY,r=E-j,p=Y-H;o.x+=r,o.y+=p,j=E,H=Y}ut(()=>(e&&(s=e.getContext("2d"),F(),o.x=e.width/2,o.y=e.height-80),window.addEventListener("keydown",st),window.addEventListener("keyup",rt),window.addEventListener("resize",F),()=>{window.removeEventListener("keydown",st),window.removeEventListener("keyup",rt),window.removeEventListener("resize",F)}));function F(){const u=document.querySelector(".relative.max-w-lg");u&&(e.width=u.offsetWidth,e.height=u.offsetHeight)}const Rt=kt(()=>t(a)?t(a).health/t(a).maxHealth*100:0);var A=Kt();Xt(u=>{var E=Dt();pt(u,E)}),A.__touchstart=_t,A.__touchmove=Tt,A.__touchend=[$t];var W=P(A),at=P(W);jt(at,u=>e=u,()=>e);var q=M(at,2),O=P(q),Mt=P(O);S(O);var ot=M(O,2),Pt=P(ot);S(ot),S(q);var N=M(q,2);let nt;var St=P(N);let lt;S(N);var G=M(N,2);let ht;var Et=M(P(G),4);Et.__click=D,S(G);var K=M(G,2);let ct;var J=M(P(K),2),It=P(J);S(J);var Bt=M(J,2);Bt.__click=D,S(K),S(W);var dt=M(W,2),Q=P(dt);Q.__touchstart=[Ft,g],Q.__touchend=[Wt,g];var ft=M(Q,2);ft.__touchstart=[qt,g],ft.__touchend=[Ot,g],S(dt),S(A),Lt((u,E,Y,r)=>{Z(Mt,`スコア: ${t(n)??""}`),Z(Pt,`残機: ${t(h)??""}`),nt=tt(N,1,"absolute top-2 left-1/2 -translate-x-1/2 w-4/5 md:w-3/5 h-6 bg-gray-700 rounded-full shadow-lg overflow-hidden",null,nt,u),lt=Gt(St,"",lt,E),ht=tt(G,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ht,Y),ct=tt(K,1,"absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-center z-20 p-4",null,ct,r),Z(It,`最終スコア: ${t(n)??""}`)},[()=>({hidden:!t(a)}),()=>({width:`${t(Rt)}%`}),()=>({hidden:t(v)}),()=>({hidden:!t(f)})]),pt(l,A),Yt()}Ct(["touchstart","touchmove","touchend","click"]);export{ie as component};
